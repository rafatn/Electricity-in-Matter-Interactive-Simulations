<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MGF/CGF ×œ××¨×—×‘ ×¤×ª×¨×•× ×•×ª â€” ××•×× ×˜×™×, LN (×“×¦×™×‘×œ×™×), ×•×“×œ×ª× ×©×œ ×§×¨×•× ×™×§×¨</title>
  <meta name="color-scheme" content="light dark">

  <!-- KaTeX -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" crossorigin="anonymous">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" crossorigin="anonymous"></script>

  <style>
    :root{
      --bg0:#f4f6fb; --bg1:#eef2ff; --bg2:#ecfeff;
      --card:rgba(255,255,255,.78);
      --card2:rgba(255,255,255,.60);
      --text:#0f172a; --muted:#64748b; --line:rgba(148,163,184,.35);
      --head:#0b1220; --link:#2563eb; --shadow:0 18px 50px rgba(2,6,23,.10);
      --r:18px;
      --ok:#16a34a; --warn:#f59e0b; --bad:#ef4444; --accent:#6366f1;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }
    @media (prefers-color-scheme: dark){
      :root{
        --bg0:#0b1020; --bg1:#0b1430; --bg2:#061a22;
        --card:rgba(17,24,39,.66);
        --card2:rgba(17,24,39,.44);
        --text:#e5e7eb; --muted:#94a3b8; --line:rgba(148,163,184,.20);
        --head:#f8fafc; --link:#93c5fd; --shadow:0 18px 50px rgba(0,0,0,.35);
      }
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text);
      background:
        radial-gradient(1200px 800px at 20% 10%, var(--bg2), transparent 60%),
        radial-gradient(1200px 800px at 90% 0%, var(--bg1), transparent 55%),
        linear-gradient(180deg, var(--bg0), #ffffff00 60%),
        var(--bg0);
      line-height:1.6;
    }
    a{color:var(--link); text-decoration:none}
    a:hover{text-decoration:underline}
    header{
      padding:28px 18px 8px;
      max-width:1100px; margin:0 auto;
    }
    .title{
      display:flex; gap:14px; align-items:flex-start; flex-wrap:wrap;
    }
    .badge{
      padding:6px 10px; border-radius:999px;
      background:linear-gradient(135deg, rgba(99,102,241,.18), rgba(14,165,233,.12));
      border:1px solid var(--line);
      font-weight:650;
      letter-spacing:.2px;
      color:var(--head);
    }
    .h1{
      font-size:clamp(22px, 3vw, 34px);
      margin:0;
      color:var(--head);
    }
    .sub{
      margin:8px 0 0;
      color:var(--muted);
      max-width:80ch;
    }
    main{
      max-width:1100px;
      margin:0 auto;
      padding:14px 18px 50px;
      display:grid;
      grid-template-columns: 320px 1fr;
      gap:14px;
    }
    @media (max-width: 980px){
      main{grid-template-columns: 1fr}
    }
    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:var(--r);
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .card .hd{
      padding:14px 16px;
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      border-bottom:1px solid var(--line);
      background:linear-gradient(180deg, rgba(255,255,255,.45), rgba(255,255,255,0));
    }
    @media (prefers-color-scheme: dark){
      .card .hd{background:linear-gradient(180deg, rgba(0,0,0,.18), rgba(0,0,0,0));}
    }
    .card .hd h2{
      margin:0; font-size:16px; color:var(--head);
    }
    .card .bd{padding:14px 16px}
    .nav a{
      display:block;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid transparent;
      color:var(--text);
      background:transparent;
    }
    .nav a:hover{
      background:var(--card2);
      border-color:var(--line);
      text-decoration:none;
    }
    .pill{
      display:inline-flex; gap:8px; align-items:center;
      padding:6px 10px; border-radius:999px;
      border:1px solid var(--line);
      background:var(--card2);
      font-size:12px; color:var(--muted);
      margin:4px 6px 0 0;
    }
    .kbox{
      padding:12px 12px;
      border-radius:14px;
      border:1px dashed var(--line);
      background:rgba(99,102,241,.07);
      overflow:auto;
    }
    .note{
      padding:12px 12px;
      border-radius:14px;
      border:1px solid var(--line);
      background:var(--card2);
      color:var(--muted);
    }
    .callout{
      padding:12px 12px;
      border-radius:14px;
      border:1px solid var(--line);
      background:linear-gradient(135deg, rgba(22,163,74,.10), rgba(99,102,241,.07));
    }
    .callout.bad{
      background:linear-gradient(135deg, rgba(239,68,68,.10), rgba(245,158,11,.08));
    }
    .callout h3{margin:0 0 6px; font-size:14px; color:var(--head)}
    .mono{font-family:var(--mono)}
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    @media (max-width: 900px){
      .grid2{grid-template-columns:1fr}
    }
    footer{
      max-width:1100px;
      margin:0 auto;
      padding:10px 18px 24px;
      color:var(--muted);
      font-size:12px;
    }
    .sep{height:1px; background:var(--line); margin:12px 0}
    .small{font-size:12px; color:var(--muted)}
    .btnrow{display:flex; gap:10px; flex-wrap:wrap}
    button{
      cursor:pointer;
      border:1px solid var(--line);
      background:var(--card2);
      color:var(--text);
      border-radius:12px;
      padding:10px 12px;
      font-weight:650;
    }
    button:hover{filter:brightness(1.03)}
    input[type="number"]{
      width:100%;
      border:1px solid var(--line);
      background:rgba(255,255,255,.5);
      color:var(--text);
      border-radius:12px;
      padding:10px 12px;
      outline:none;
    }
    @media (prefers-color-scheme: dark){
      input[type="number"]{background:rgba(17,24,39,.55)}
    }
    .mini{
      font-size:12px;
      color:var(--muted);
      margin-top:6px;
    }
  </style>
</head>

<body>
<header>
  <div class="title">
    <span class="badge">LN â€¢ MGF/CGF â€¢ ××•×× ×˜×™×</span>
    <h1 class="h1">×¤×•× ×§×¦×™×” ×™×•×¦×¨×ª ××•×× ×˜×™× ×œ××¨×—×‘ ×¤×ª×¨×•× ×•×ª (SAT) + ×“×¦×™×‘×œ×™× + ×“×œ×ª× ×©×œ ×§×¨×•× ×™×§×¨</h1>
  </div>
  <p class="sub">
    ×”××˜×¨×”: ×œ×”×¦×™×’ ×× ×’× ×•×Ÿ â€œ×¨×™×›×•×š ×× ×œ×™×˜×™â€ ×©××™×™×¦×¨ ××•×× ×˜×™× (MGF/CGF) ××”×”×ª×¤×œ×’×•×ª ×”××©×•×§×œ×œ×ª ×¢×œ ×¤×ª×¨×•× ×•×ª,
    ×•×œ×”×¨××•×ª ××™×¤×” ×”×•× ×¢×•×‘×“ (×¤×¨×•×¤×™×œ ×©×›×‘×•×ª/×¨×™×‘×•×™ ×¤×ª×¨×•× ×•×ª) ×•××™×¤×” ×”×•× × ×©×‘×¨ ×‘××•×¤×Ÿ ×¢×§×¨×•× ×™ (×“×œ×ª× ×©×œ ×§×¨×•× ×™×§×¨ â€” ×¤×ª×¨×•×Ÿ ×™×—×™×“).
  </p>
</header>

<main>
  <!-- Sidebar -->
  <aside class="card">
    <div class="hd"><h2>× ×™×•×•×˜</h2><span class="pill">×ª××¦×™×ª</span></div>
    <div class="bd nav">
      <a href="#setup">1) ×”×’×“×¨×•×ª: ×¤×ª×¨×•× ×•×ª, ×©×›×‘×•×ª ××¨×—×§, ××©×§×œ</a>
      <a href="#mgf">2) MGF/CGF: ×¤×•× ×§×¦×™×” ×™×•×¦×¨×ª ××•×× ×˜×™×</a>
      <a href="#derivatives">3) × ×’×–×¨×•×ª: ×ª×•×—×œ×ª/×©×•× ×•×ª (××•×× ×˜×™×/×§×•××•×œ× ×˜×™×)</a>
      <a href="#ln-db">4) LN ×›Ö¾×“×¦×™×‘×œ×™×: LogSumExp</a>
      <a href="#kronecker">5) ×”××§×¨×” ×”×‘×¢×™×™×ª×™: ×“×œ×ª× ×©×œ ×§×¨×•× ×™×§×¨</a>
      <a href="#useful">6) ××ª×™ ×–×” ×›×Ÿ ××•×¢×™×œ: ×ª× ××™ ×¤×¨×•×¤×™×œ â€œ×—×œ×§â€</a>
      <a href="#mini">7) ×“×•×’××” ××™× ×™××œ×™×ª ××™× ×˜×•××™×˜×™×‘×™×ª</a>
    </div>
    <div class="sep"></div>
    <div class="bd">
      <div class="note">
        <div style="font-weight:800; color:var(--head); margin-bottom:6px;">×¨×¢×™×•×Ÿ ××¨×›×–×™</div>
        ×¢×•×‘×“×™× ×‘×œ×•×’×¨×ª××™× (\(\ln\)) ×›×™ ×¡×›×•××™× ××§×¡×¤×•× × ×¦×™××œ×™×™× × ×¢×©×™× ×™×¦×™×‘×™×:
        \[
          \ln\sum_k e^{A_k} \approx \max_k A_k \;+\; \text{×ª×™×§×•×Ÿ ×§×˜×Ÿ}
        \]
        ×‘×“×™×•×§ ×›××• â€œ×—×™×‘×•×¨ ×”×¡×¤×§×™×â€ ×‘×“×¦×™×‘×œ×™×.
      </div>
      <div class="sep"></div>

      <div class="callout">
        <h3>ğŸ§© ××” × ×‘× ×” ×›××Ÿ?</h3>
        <div class="small">
          ×¤×•× ×§×¦×™×” ×™×•×¦×¨×ª ××•×× ×˜×™× ×œ××¨×—×§ \(d(a,c)\) ×‘×ª×•×š ×§×‘×•×¦×ª ×”×¤×ª×¨×•× ×•×ª \(S(\varphi)\) ×‘××©×§×œ ×‘×•×œ×¦××Ÿ,
          ×•××– LN (CGF) ×©××—×–×™×¨ ×ª×•×—×œ×ª/×©×•× ×•×ª ×•×›×•×³ ×¢×´×™ × ×’×–×¨×•×ª.
        </div>
      </div>
    </div>
  </aside>

  <!-- Content -->
  <section class="card">
    <div class="hd"><h2>××¡××š ×× ×œ×™×˜×™ ×§×¦×¨ ×•××“×•×™×§</h2><span class="pill mono">KaTeX</span></div>
    <div class="bd">

      <!-- 1) Setup -->
      <h2 id="setup">1) ×”×’×“×¨×•×ª: ×¤×ª×¨×•× ×•×ª, ×©×›×‘×•×ª ××¨×—×§, ××©×§×œ</h2>
      <p>
        × ×ª×•× ×” × ×•×¡×—×ª CNF \(\varphi(x_1,\dots,x_n)\). ×§×‘×•×¦×ª ×”×¤×ª×¨×•× ×•×ª:
        \[
          S(\varphi)=\{a\in\{0,1\}^n:\ \varphi(a)=1\}.
        \]
        ×‘×•×—×¨×™× â€œ××¨×›×–â€ \(c\in\{0,1\}^n\) (×™×›×•×œ ×œ×”×™×•×ª ×’×¨×™×“×™/×”×’×“×¨×” ××—×¨×ª),
        ×•××¨×—×§ ×”×××™× ×’:
        \[
          d(a,c)=\sum_{i=1}^n \mathbf{1}[a_i\ne c_i].
        \]
      </p>

      <div class="grid2">
        <div class="kbox">
          <div style="font-weight:800; margin-bottom:6px;">×©×›×‘×•×ª ××¨×—×§</div>
          × ×¡××Ÿ:
          \[
            N_k(\varphi;c)=|\{a\in S(\varphi): d(a,c)=k\}|.
          \]
          ×•××– ×›×œ ×¡×›×•× ××©×•×§×œ×œ ×¢×œ ×¤×ª×¨×•× ×•×ª ××ª×¤×¨×§ ×œ×©×›×‘×•×ª:
          \[
            \sum_{a\in S(\varphi)} f(d(a,c))=\sum_{k=0}^n N_k(\varphi;c)\,f(k).
          \]
        </div>
        <div class="kbox">
          <div style="font-weight:800; margin-bottom:6px;">××©×§×œ ×‘×•×œ×¦××Ÿ (××§×¡×¤×•× × ×¦×™××œ×™)</div>
          × ×’×“×™×¨ ××©×§×œ:
          \[
            w_\beta(a)=e^{-\beta d(a,c)}\quad (\beta>0).
          \]
          ×•×”×¡×›×•× ×”××©×•×§×œ×œ (×´××¡×”×´):
          \[
            M_\beta(\varphi;c)=\sum_{a\in S(\varphi)} e^{-\beta d(a,c)}
            =\sum_{k=0}^n N_k(\varphi;c)e^{-\beta k}.
          \]
        </div>
      </div>

      <div class="note" style="margin-top:12px;">
        <b>×”×¢×¨×” ×—×©×•×‘×”:</b> ×¢×œ <u>×›×œ</u> \(\{0,1\}^n\) (×‘×œ×™ ××™×œ×•×¥ SAT) ××ª×§×™×™× ×‘×™× ×•× × ×™×•×˜×•×Ÿ:
        \[
          \sum_{k=0}^n \binom{n}{k}e^{-\beta k}=(1+e^{-\beta})^n.
        \]
        ××‘×œ ××¦×œ× ×• ×”××§×“××™× ×”× \(N_k(\varphi;c)\) (×ª×œ×•×™×™× ×‘×¤×ª×¨×•× ×•×ª) â€” ×•×œ×›×Ÿ ×–×” ×”××§×•× ×©×‘×• ×”×›×•×—/×”×§×•×©×™ × ××¦×.
      </div>

      <div class="sep"></div>

      <!-- 2) MGF/CGF -->
      <h2 id="mgf">2) MGF/CGF: ×¤×•× ×§×¦×™×” ×™×•×¦×¨×ª ××•×× ×˜×™×</h2>
      <p>
        ×›×“×™ ×œ×§×‘×œ â€œ×¤×•× ×§×¦×™×” ×™×•×¦×¨×ª ××•×× ×˜×™×â€ ×œ××¨×—×§ \(d\) ×‘×ª×•×š ×¤×ª×¨×•× ×•×ª,
        × ×‘× ×” ×”×ª×¤×œ×’×•×ª ××©×•×§×œ×œ×ª ×¢×œ ×”×¤×ª×¨×•× ×•×ª:
      </p>

      <div class="kbox">
        \[
          \Pr_\beta(a)=\frac{\mathbf{1}[\varphi(a)=1]\;e^{-\beta d(a,c)}}{M_\beta(\varphi;c)}
          \quad,\quad a\in\{0,1\}^n.
        \]
        ×›×š ×©-\(M_\beta\) ×”×•× ×”× ×•×¨××œ×™×–×¦×™×” (×´×¤×•× ×§×¦×™×™×ª ×—×œ×•×§×” ×¢×œ ×¤×ª×¨×•× ×•×ª×´).
      </div>

      <p>
        ×¢×›×©×™×• × ×’×“×™×¨ ×¤×•× ×§×¦×™×” ×™×•×¦×¨×ª ××•×× ×˜×™× (MGF) ×©×œ ×”××©×ª× ×” ×”××§×¨××™
        \(D:=d(A,c)\) ×›××©×¨ \(A\sim\Pr_\beta\):
      </p>

      <div class="kbox">
        <div style="font-weight:800; margin-bottom:6px;">MGF (Moment Generating Function)</div>
        \[
          \mathrm{MGF}_D(t)=\mathbb{E}_\beta[e^{tD}]
          =\sum_{a\in S(\varphi)} \Pr_\beta(a)\,e^{t d(a,c)}
          =\frac{\sum_{a\in S(\varphi)} e^{-(\beta-t)d(a,c)}}{\sum_{a\in S(\varphi)} e^{-\beta d(a,c)}}
          =\frac{M_{\beta-t}(\varphi;c)}{M_{\beta}(\varphi;c)}.
        \]
      </div>

      <p>
        ×•×œ×¦×“ ×–×” × ×’×“×™×¨ ××ª ×”×¤×•× ×§×¦×™×” ×”×™×•×¦×¨×ª ×§×•××•×œ× ×˜×™× (CGF) ×‘×¢×–×¨×ª LN:
      </p>

      <div class="kbox">
        <div style="font-weight:800; margin-bottom:6px;">CGF (Cumulant Generating Function)</div>
        \[
          \mathrm{CGF}_D(t)=\ln \mathrm{MGF}_D(t)
          =\ln M_{\beta-t}(\varphi;c)-\ln M_{\beta}(\varphi;c).
        \]
      </div>

      <div class="callout" style="margin-top:12px;">
        <h3>âœ… ××” ×”×¨×•×•×—?</h3>
        ×× ××ª×” ×™×•×“×¢ ×œ×—×©×‘ (××• ×œ×”×¢×¨×™×š) \(\ln M_\beta\) ×›×ª×œ×•×ª ×‘-\(\beta\),
        ××ª×” ××§×‘×œ ××•×× ×˜×™×/×§×•××•×œ× ×˜×™× ×©×œ \(D\) ×¢×´×™ × ×’×–×¨×•×ª â€” ×‘×“×™×•×§ ×›××• ×‘××•×ª×•×ª: LN ×”×•×¤×š ××›×¤×œ×”/×¡×›×•× ×œ××“×™×˜×™×‘×™.
      </div>

      <div class="sep"></div>

      <!-- 3) Derivatives -->
      <h2 id="derivatives">3) × ×’×–×¨×•×ª: ×ª×•×—×œ×ª/×©×•× ×•×ª (××•×× ×˜×™× ×•×§×•××•×œ× ×˜×™×)</h2>

      <p>
        × ×’×–×¨×•×ª ×œ×•×’×¨×ª××™×•×ª ×©×œ \(M_\beta\) ××—×–×™×¨×•×ª ××•×× ×˜×™× (××• ×§×•××•×œ× ×˜×™×) ×©×œ ××¨×—×§ ×”×××™× ×’ ×ª×—×ª \(\Pr_\beta\):
      </p>

      <div class="grid2">
        <div class="kbox">
          <div style="font-weight:800; margin-bottom:6px;">×ª×•×—×œ×ª ××¨×—×§</div>
          \[
            \frac{d}{d\beta}\ln M_\beta(\varphi;c)
            =\frac{1}{M_\beta}\frac{dM_\beta}{d\beta}
            =\frac{1}{M_\beta}\sum_{a\in S(\varphi)}(-d(a,c))e^{-\beta d(a,c)}
            =-\mathbb{E}_\beta[D].
          \]
          ×›×œ×•××¨:
          \[
            \boxed{\mathbb{E}_\beta[D]=-\frac{d}{d\beta}\ln M_\beta.}
          \]
        </div>

        <div class="kbox">
          <div style="font-weight:800; margin-bottom:6px;">×©×•× ×•×ª ××¨×—×§ (×§×•××•×œ× ×˜ ×©× ×™)</div>
          \[
            \frac{d^2}{d\beta^2}\ln M_\beta
            =\mathrm{Var}_\beta(D)\ \ge 0.
          \]
          ×œ×›×Ÿ \(\ln M_\beta\) ×”×™× ×¤×•× ×§×¦×™×” ×§××•×¨×” ×‘-\(\beta\) (×™×¦×™×‘×•×ª ×× ×œ×™×˜×™×ª).
        </div>
      </div>

      <div class="note" style="margin-top:12px;">
        ××•×ª×• ×¨×¢×™×•×Ÿ ×¢×•×‘×“ ×’× ×¢×œ ××¨×’â€™×™× ×œ×™× ×©×œ ×‘×™×˜ \(x_i\) ×“×¨×š ×¡×›×•××™× ××•×ª× ×™×
        \(M_\beta^{(i,1)}\), \(M_\beta^{(i,0)}\),
        ×•××–:
        \[
          p_i(\beta)=\Pr_\beta[A_i=1]=\frac{M_\beta^{(i,1)}}{M_\beta^{(i,1)}+M_\beta^{(i,0)}}.
        \]
        ××‘×œ ×›×“×™ ×œ×”×©×ª××© ×‘×–×” ××œ×’×•×¨×™×ª××™×ª ×¦×¨×™×š ×“×¨×š ×œ×—×©×‘/×œ×”×¢×¨×™×š ××ª ×”×¡×›×•××™× ×”××œ×” ×‘×¤×•×œ×™× ×•× ×–××Ÿ.
      </div>

      <div class="sep"></div>

      <!-- 4) LN & dB -->
      <h2 id="ln-db">4) LN ×›Ö¾×“×¦×™×‘×œ×™×: LogSumExp ×•×”×´××™×‘×¨ ×”×“×•××™× × ×˜×™×´</h2>
      <p>
        ×›×ª×•×‘ ××ª ×”××¡×” ×œ×¤×™ ×©×›×‘×•×ª:
        \[
          M_\beta=\sum_{k=0}^n N_k e^{-\beta k}.
        \]
        × ×¢×‘×•×¨ ×œÖ¾LN:
        \[
          \ln M_\beta=\ln\sum_{k=0}^n \exp(\ln N_k-\beta k).
        \]
        ×–×”×• ×‘×“×™×•×§ <span class="mono">LogSumExp</span>.
      </p>

      <div class="kbox">
        × ×¡××Ÿ \(A_k=\ln N_k-\beta k\). ××–:
        \[
          \max_k A_k \le \ln\sum_k e^{A_k}\le \max_k A_k + \ln(n+1).
        \]
        ×›×œ×•××¨ â€œ×”××¦×‘ ×”×—×–×§â€ ×©×•×œ×˜, ×•×©××¨ ×”××™×‘×¨×™× ××•×¡×™×¤×™× ×ª×™×§×•×Ÿ ×œ×•×’×¨×ª××™ ×§×˜×Ÿ â€” ×›××• ×—×™×‘×•×¨ ××§×•×¨×•×ª ×‘×“×¦×™×‘×œ×™×.
      </div>

      <div class="callout" style="margin-top:12px;">
        <h3>ğŸ“¶ ×× ×œ×•×’×™×™×ª ××•×ª×•×ª (SNR)</h3>
        ×× ×™×© ×¤×¢×¨ \(\Delta\) ×‘×™×Ÿ \(A_{k^\*}\) ×œ×‘×™×Ÿ ×›×œ ×”××—×¨×™×,
        ××– ×”×ª×™×§×•×Ÿ ×§×˜×Ÿ ×××•×“:
        \[
          \ln\sum_k e^{A_k} = A_{k^\*} + \ln\!\Big(1+\sum_{k\ne k^\*}e^{A_k-A_{k^\*}}\Big),
        \]
        ×•×× \(A_k\le A_{k^\*}-\Delta\) ××–:
        \[
          \ln\sum_k e^{A_k}\le A_{k^\*}+\ln(1+n e^{-\Delta}).
        \]
      </div>

      <div class="sep"></div>

      <!-- 5) Kronecker delta -->
      <h2 id="kronecker">5) ×”××§×¨×” ×”×‘×¢×™×™×ª×™: ×“×œ×ª× ×©×œ ×§×¨×•× ×™×§×¨ (×¤×ª×¨×•×Ÿ ×™×—×™×“)</h2>
      <p>
        ×× ×œ×§×‘×•×¦×” \(S(\varphi)\) ×™×© ×¤×ª×¨×•×Ÿ ×™×—×™×“, ××– ×¢×‘×•×¨ ×›×œ ××¨×›×– \(c\) ×™×© \(k^\*=d(a^\*,c)\),
        ×•×”×ª×¤×œ×’×•×ª ×©×›×‘×•×ª ×”×•×¤×›×ª ×œ×´××™××¤×•×œ×¡×´:
        \[
          N_k(\varphi;c)=\delta_{k,k^\*}.
        \]
      </p>

      <div class="kbox">
        ××–:
        \[
          M_\beta=\sum_k \delta_{k,k^\*}e^{-\beta k}=e^{-\beta k^\*},
          \qquad
          \ln M_\beta=-\beta k^\*.
        \]
        ××™×Ÿ ×¡×›×•× ×××™×ª×™, ××™×Ÿ ×–× ×‘, ××™×Ÿ ×¨×™×›×•×– ×¡×˜×˜×™×¡×˜×™ â€œ×¨×¦×™×£â€.
      </div>

      <div class="callout bad" style="margin-top:12px;">
        <h3>â›” ×œ××” ×–×” ×—×•×¡× â€œ×¨×™×›×•×š ×× ×œ×™×˜×™â€?</h3>
        ×›×œ ×”×©×™×˜×•×ª ×”×¨×¦×™×¤×•×ª (LN, ××•×× ×˜×™×, ××™× ×˜×’×¨×œ×™×, ×˜×•×¨ ×˜×™×™×œ×•×¨, Integration by Parts)
        ×× ×¦×œ×•×ª ×¤×¨×•×¤×™×œ â€œ×—×œ×§â€ ×©×œ \(N_k\).
        ×›××©×¨ \(N_k\) ×”×•× ×“×œ×ª× ×©×œ ×§×¨×•× ×™×§×¨, ××™×Ÿ × ×’×–×¨×ª/×¤×¨×•×¤×™×œ/×¤×¢×¨ ×¡×˜×˜×™×¡×˜×™ ×©××¤×©×¨ ×œ×—×œ×¥ ××× ×• ×›×™×•×•×Ÿ ×—×™×¤×•×©.
      </div>

      <div class="sep"></div>

      <!-- 6) When useful -->
      <h2 id="useful">6) ××ª×™ ×–×” ×›×Ÿ ××•×¢×™×œ: ×ª× ××™ ×¤×¨×•×¤×™×œ â€œ×—×œ×§â€ (×•××– ××•×× ×˜×™× ×‘×××ª × ×•×ª× ×™× ××™×“×¢)</h2>
      <p>
        ×›×“×™ ×©×”Ö¾MGF/CGF ×™×”×™×• â€œ××™× ×¤×•×¨××˜×™×‘×™×™×â€ ×¦×¨×™×š ×©×œ×©×›×‘×•×ª ×ª×”×™×” ×”×ª×¤×œ×’×•×ª ×œ×Ö¾××™××¤×•×œ×¡×™×‘×™×ª, ×œ××©×œ:
      </p>

      <div class="grid2">
        <div class="kbox">
          <div style="font-weight:800; margin-bottom:6px;">×ª× ××™ ×¤×¨×•×¤×™×œ ×©×›×‘×•×ª (×¡×’× ×•×Ÿ ×× ×˜×¨×•×¤×™)</div>
          × × ×™×— ×©×§×™×™× \(f(x)\) ×›×š ×©:
          \[
            N_{nx}(\varphi;c)\approx \exp(n f(x)) \quad (x\in[0,1]).
          \]
          ×•××–:
          \[
            \ln M_\beta \approx \ln\int_0^1 \exp(n(f(x)-\beta x))\,dx
          \]
          ×•××ª××¤×©×¨ × ×™×ª×•×— â€œ××§×¡×™××•× + ×ª×™×§×•×Ÿâ€.
        </div>
        <div class="kbox">
          <div style="font-weight:800; margin-bottom:6px;">×ª×•×¦××” ×¤×¨×§×˜×™×ª</div>
          ×× \(f(x)\) ×—×œ×§/×§×¢×•×¨ ×•×™×© ××§×¡×™××•× ×™×—×™×“,
          ××– \(\ln M_\beta\) × ×©×œ×˜ ×¢×´×™ ×©×›×‘×” ×“×•××™× × ×˜×™×ª, ×•×”× ×’×–×¨×•×ª ××—×–×™×¨×•×ª ×ª×•×—×œ×ª/×©×•× ×•×ª ×™×¦×™×‘×•×ª.
          ×–×” ×ª×•××š ×‘×× ×’× ×•×Ÿ â€œ×‘×—×¨ ×‘×™×˜â€ ×“×¨×š ××¨×’â€™×™× ×œ×™× â€” <i>××‘×œ</i> ×œ×¨×•×‘ ×¨×§ ×‘××©×¤×—×•×ª ×¢× ××‘× ×” (×›×’×•×Ÿ treewidth ×§×˜×Ÿ).
        </div>
      </div>

      <div class="note" style="margin-top:12px;">
        <b>××¡×§× ×”:</b>
        â€œ×¤×•× ×§×¦×™×” ×™×•×¦×¨×ª ××•×× ×˜×™×â€ ×”×™× ×›×œ×™ ×× ×œ×™×˜×™ ×—×–×§,
        ××‘×œ ×›×“×™ ×œ×”×¤×•×š ××•×ª×” ×œ×× ×’× ×•×Ÿ ×—×™×©×•×‘×™ ×›×œ×œ×™ ×¦×¨×™×š ×’×™×©×” ×œ-\(M_\beta\) (××• ×œ-\(\ln M_\beta\)) ×‘×¦×•×¨×” ×™×¢×™×œ×”,
        ××• ×œ×”× ×™×—/×œ×”×•×›×™×— ×¤×¨×•×¤×™×œ ×©×›×‘×•×ª ××ª××™×. ×‘××§×¨×” ×”×“×œ×ª× (×¤×ª×¨×•×Ÿ ×™×—×™×“) ××™×Ÿ ×¤×¨×•×¤×™×œ ×¨×¦×™×£ ×©××¤×©×¨ ×œ× ×¦×œ.
      </div>

      <div class="sep"></div>

      <!-- 7) Mini example -->
      <h2 id="mini">7) ×“×•×’××” ××™× ×™××œ×™×ª ××™× ×˜×•××™×˜×™×‘×™×ª</h2>
      <p class="small">
        ×›××Ÿ ×¨×§ â€œ××—×©×‘×•×Ÿ ××™× ×˜×•××™×˜×™×‘×™â€ ×©××¨××” ××” ×§×•×¨×” ×œ-\(\ln M_\beta\) ×›××©×¨ \(N_k\) ×”×•× (×) ××™××¤×•×œ×¡, (×‘) ×©×›×‘×” ×¨×—×‘×”.
        ×œ× ××ª×™×™××¨ ×œ×¤×ª×•×¨ SAT â€” ×¨×§ ×œ×”××—×™×© ××ª ×”×”×‘×“×œ ×‘×™×Ÿ ×“×œ×ª× ×œ×¤×¨×•×¤×™×œ ××¤×•×–×¨.
      </p>

      <div class="grid2">
        <div class="card" style="box-shadow:none;">
          <div class="hd"><h2>××•×“×œ A: ×“×œ×ª× (×¤×ª×¨×•×Ÿ ×™×—×™×“)</h2><span class="pill">Kronecker</span></div>
          <div class="bd">
            <label class="small">×‘×—×¨ \(k^\*\) (××¨×—×§ ×”×¤×ª×¨×•×Ÿ ××”××¨×›×–)</label>
            <input id="kstar" type="number" min="0" value="20" />
            <div class="mini">×‘××•×“×œ ×–×”: \(N_k=\delta_{k,k^\*}\) ×•×œ×›×Ÿ \(M_\beta=e^{-\beta k^\*}\).</div>
          </div>
        </div>

        <div class="card" style="box-shadow:none;">
          <div class="hd"><h2>××•×“×œ B: ×©×›×‘×” ×¨×—×‘×”</h2><span class="pill">Wide profile</span></div>
          <div class="bd">
            <label class="small">×‘×—×¨ ×¤×¨××˜×¨ â€œ×¨×•×—×‘â€ \(\sigma\) (×’×“×•×œ = ××¤×•×–×¨)</label>
            <input id="sigma" type="number" min="1" value="6" />
            <div class="mini">
              ×›××Ÿ × ×©×ª××© ×‘×¤×¨×•×¤×™×œ â€œ×“××•×™ ×’××•×¡â€ ×¢×œ \(k\): \(N_k\propto e^{-\frac{(k-\mu)^2}{2\sigma^2}}\) (×œ×”××—×©×” ×‘×œ×‘×“).
            </div>
          </div>
        </div>
      </div>

      <div class="card" style="margin-top:12px; box-shadow:none;">
        <div class="hd"><h2>×—×©×‘ \(\ln M_\beta\) ×¢×œ ×¤× ×™ \(\beta\)</h2><span class="pill mono">demo</span></div>
        <div class="bd">
          <div class="grid2">
            <div>
              <label class="small">×‘×—×¨ \(n\) (××¡×³ ×©×›×‘×•×ª \(0..n\))</label>
              <input id="nval" type="number" min="5" value="60" />
              <div class="mini">×–×” ×¨×§ ×œ×¦×™×•×¨/×¡×›×™××”, ×œ× ×§×©×•×¨ ×œÖ¾SAT ×××™×ª×™ ×›××Ÿ.</div>
            </div>
            <div>
              <label class="small">×‘×—×¨ \(\mu\) ×œ××•×“×œ ×”×¨×—×‘</label>
              <input id="mu" type="number" min="0" value="25" />
              <div class="mini">××¨×›×– ×©×›×‘×•×ª ×©×œ ××•×“×œ B.</div>
            </div>
          </div>

          <div class="btnrow" style="margin-top:10px;">
            <button id="run">×—×©×‘</button>
            <button id="copyEq">×”×¢×ª×§ × ×•×¡×—××•×ª ××¨×›×–×™×•×ª</button>
          </div>

          <div class="sep"></div>
          <div id="out" class="kbox" aria-live="polite"></div>
          <div class="mini">
            ×©×™× ×œ×‘: ×‘××•×“×œ ×”×“×œ×ª× \(\ln M_\beta\) ×œ×™× ×™××¨×™ ×‘-\(\beta\), ××™×Ÿ â€œ×ª×™×§×•×Ÿâ€. ×‘××•×“×œ ×”×¨×—×‘ \(\ln M_\beta\) ××¨××” ×”×ª× ×”×’×•×ª â€œLogSumExpâ€.
          </div>
        </div>
      </div>

    </div>
  </section>
</main>

<footer>
  <div class="sep"></div>
  <div>×›×œ ×”×–×›×•×™×•×ª ×©××•×¨×•×ª. ××™×Ÿ ×œ×©×›×¤×œ ××œ× ×‘××™×©×•×¨ ××¨××©. (×œ×©×™××•×© ×¤×¨×˜×™/×œ×™××•×“×™: ×”×ª×××” ×•×”×¨×—×‘×” ×œ×¤×™ ×”×¦×•×¨×š)</div>
</footer>

<script>
  // KaTeX auto-render
  window.addEventListener("DOMContentLoaded", () => {
    if (window.renderMathInElement) {
      renderMathInElement(document.body, {
        delimiters: [
          {left: "$$", right: "$$", display: true},
          {left: "\\[", right: "\\]", display: true},
          {left: "$", right: "$", display: false},
          {left: "\\(", right: "\\)", display: false}
        ]
      });
    }
  });

  function lnSumExp(arr){
    // stable log-sum-exp
    let m = -Infinity;
    for (const x of arr) if (x > m) m = x;
    if (!isFinite(m)) return -Infinity;
    let s = 0;
    for (const x of arr) s += Math.exp(x - m);
    return m + Math.log(s);
  }

  function compute(){
    const n = Math.max(5, Math.floor(Number(document.getElementById('nval').value || 60)));
    const kstar = Math.max(0, Math.min(n, Math.floor(Number(document.getElementById('kstar').value || 20))));
    const sigma = Math.max(1, Number(document.getElementById('sigma').value || 6));
    const mu = Math.max(0, Math.min(n, Number(document.getElementById('mu').value || 25)));

    // define a few beta points
    const betas = [0, 0.02, 0.05, 0.10, 0.20, 0.35, 0.50, 0.75, 1.0];

    // Model A: delta profile N_k = delta_{k,k*}
    // ln M_beta = ln(e^{-beta k*}) = -beta k*
    const rowsA = betas.map(b => ({beta:b, lnM: -b * kstar}));

    // Model B: wide gaussian-ish profile on k (illustration)
    // N_k âˆ exp(-(k-mu)^2 / (2 sigma^2)). We'll compute lnN_k up to constant.
    // ln M_beta = ln sum_k exp(lnN_k - beta k) ; constant cancels, ok for shape.
    function lnN(k){
      const z = (k - mu) / sigma;
      return -0.5 * z * z;
    }

    const rowsB = betas.map(b => {
      const Ak = [];
      for (let k=0;k<=n;k++){
        Ak.push(lnN(k) - b * k);
      }
      return {beta:b, lnM: lnSumExp(Ak)};
    });

    // show results
    let html = '';
    html += '<div style="font-weight:900; margin-bottom:6px;">×ª×•×¦××•×ª (×”××—×©×”):</div>';
    html += '<div class="small">××•×“×œ A = ×“×œ×ª× (×¤×ª×¨×•×Ÿ ×™×—×™×“), ××•×“×œ B = ×¤×¨×•×¤×™×œ ×©×›×‘×•×ª ×¨×—×‘ (×“××•×™ ×’××•×¡).</div>';
    html += '<div class="sep"></div>';

    html += '<div class="grid2">';
    html += '<div><div style="font-weight:800; margin-bottom:6px;">××•×“×œ A: \\(\\ln M_\\beta = -\\beta k^*\\)</div>';
    html += '<div class="kbox mono">';
    html += 'beta\tlnM\n';
    rowsA.forEach(r => { html += `${r.beta.toFixed(2)}\t${r.lnM.toFixed(4)}\n`; });
    html += '</div></div>';

    html += '<div><div style="font-weight:800; margin-bottom:6px;">××•×“×œ B: \\(\\ln M_\\beta=\\ln\\sum_k e^{\\ln N_k-\\beta k}\\)</div>';
    html += '<div class="kbox mono">';
    html += 'beta\tlnM\n';
    rowsB.forEach(r => { html += `${r.beta.toFixed(2)}\t${r.lnM.toFixed(4)}\n`; });
    html += '</div></div>';
    html += '</div>';

    html += '<div class="sep"></div>';
    html += '<div class="note"><b>×¤×™×¨×•×©:</b> ×‘××•×“×œ A ××™×Ÿ â€œ×¨×™×›×•×– + ×ª×™×§×•×Ÿâ€ â€” ×–×• ×‘×“×™×•×§ ×“×œ×ª× ×©×œ ×§×¨×•× ×™×§×¨. ×‘××•×“×œ B, \\(\\ln M_\\beta\\) ×”×•× LogSumExp ×•×œ×›×Ÿ × ×©×œ×˜ ×¢×´×™ ××™×‘×¨ ×“×•××™× × ×˜×™ ×¢× ×ª×™×§×•×Ÿ ×§×˜×Ÿ.</div>';

    document.getElementById('out').innerHTML = html;

    // re-render math inside out
    if (window.renderMathInElement) {
      renderMathInElement(document.getElementById('out'), {
        delimiters: [
          {left: "$$", right: "$$", display: true},
          {left: "\\[", right: "\\]", display: true},
          {left: "$", right: "$", display: false},
          {left: "\\(", right: "\\)", display: false}
        ]
      });
    }
  }

  document.getElementById('run').addEventListener('click', compute);
  document.getElementById('copyEq').addEventListener('click', async () => {
    const txt =
`× ×•×¡×—××•×ª ××¨×›×–×™×•×ª:

S(Ï†) = { a in {0,1}^n : Ï†(a)=1 }
d(a,c) = Hamming(a,c)

N_k(Ï†;c) = |{ a in S(Ï†) : d(a,c)=k }|

M_Î²(Ï†;c) = Î£_{a in S(Ï†)} e^{-Î² d(a,c)} = Î£_{k=0}^n N_k e^{-Î² k}

×”×ª×¤×œ×’×•×ª ××©×•×§×œ×œ×ª:
P_Î²(a) = 1[Ï†(a)=1] e^{-Î² d(a,c)} / M_Î²(Ï†;c)

MGF ×©×œ D=d(A,c):
MGF_D(t) = E_Î²[e^{tD}] = M_{Î²-t}(Ï†;c) / M_Î²(Ï†;c)

CGF:
CGF_D(t) = ln M_{Î²-t}(Ï†;c) - ln M_Î²(Ï†;c)

× ×’×–×¨×•×ª ×œ×•×’×¨×ª××™×•×ª:
E_Î²[D] = - d/dÎ² ln M_Î²
Var_Î²(D) = d^2/dÎ²^2 ln M_Î² â‰¥ 0

××§×¨×” ×“×œ×ª× (×¤×ª×¨×•×Ÿ ×™×—×™×“):
N_k = Î´_{k,k*} â‡’ M_Î² = e^{-Î² k*}, ln M_Î² = -Î² k*`;
    try{
      await navigator.clipboard.writeText(txt);
      alert("×”×•×¢×ª×§ ×œ×œ×•×—.");
    }catch(e){
      alert("×œ× ×”×¦×œ×—×ª×™ ×œ×”×¢×ª×™×§ (×™×™×ª×›×Ÿ ×©×”×“×¤×“×¤×Ÿ ×—×¡×). ××¤×©×¨ ×œ×‘×—×•×¨ ×•×œ×”×¢×ª×™×§ ×™×“× ×™×ª ××”×§×•×“.");
    }
  });

  // run once by default
  compute();
</script>
</body>
</html>
