<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>××¡××š ×¤×˜× ×˜ â€“ ××‘×˜×—×ª ××™×“×¢ ×”×™×‘×¨×™×“×™×ª IPv6 + Bluetooth + MAC + IPv4/APIPA</title>
  <meta name="description" content="××¡××š ×¤×˜× ×˜ ××¢×•×¦×‘ ×”×›×•×œ×œ ×ª×‘×™×¢×•×ª (Claims), ×”×¡×‘×¨×™× ××¤×•×¨×˜×™× ×•×™×™×©×•× ××¢×©×™ ×‘×¦×™×•×“ ×§×™×™× (Linux/Windows/macOS)." />

  <style>
    :root{
      --bg: #0b1220;
      --panel: rgba(255,255,255,.06);
      --panel2: rgba(255,255,255,.08);
      --card: rgba(255,255,255,.08);
      --text: #e8eefc;
      --muted: rgba(232,238,252,.72);
      --muted2: rgba(232,238,252,.55);
      --line: rgba(255,255,255,.12);
      --accent: #7c3aed;
      --accent2:#22c55e;
      --warn:#f59e0b;
      --danger:#ef4444;
      --shadow: 0 18px 60px rgba(0,0,0,.55);
      --r: 18px;
      --r2: 14px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: var(--sans);
      background:
        radial-gradient(1200px 700px at 80% -10%, rgba(124,58,237,.35), transparent 60%),
        radial-gradient(900px 600px at 10% 10%, rgba(34,197,94,.18), transparent 60%),
        radial-gradient(900px 600px at 50% 110%, rgba(59,130,246,.14), transparent 60%),
        var(--bg);
      color: var(--text);
      line-height: 1.55;
    }

    a{ color: #b9a7ff; text-decoration:none; }
    a:hover{ text-decoration:underline; }

    .wrap{
      display:grid;
      grid-template-columns: 340px 1fr;
      gap: 18px;
      padding: 18px;
      max-width: 1320px;
      margin: 0 auto;
    }

    header.hero{
      grid-column: 1 / -1;
      border: 1px solid var(--line);
      border-radius: var(--r);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      box-shadow: var(--shadow);
      padding: 18px 18px 14px;
      overflow:hidden;
      position: relative;
    }
    header.hero:before{
      content:"";
      position:absolute;
      inset:-2px;
      background: radial-gradient(700px 260px at 20% 0%, rgba(124,58,237,.35), transparent 60%),
                  radial-gradient(700px 260px at 80% 0%, rgba(34,197,94,.22), transparent 60%);
      filter: blur(14px);
      opacity: .65;
      pointer-events:none;
    }
    header.hero > *{ position:relative; }
    .heroTop{
      display:flex;
      align-items:flex-start;
      justify-content: space-between;
      gap: 14px;
      flex-wrap: wrap;
    }
    .titleBlock h1{
      margin: 0;
      font-size: 22px;
      letter-spacing: .2px;
    }
    .titleBlock p{
      margin: 6px 0 0;
      color: var(--muted);
      max-width: 74ch;
      font-size: 14px;
    }
    .chips{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
    .chip{
      border: 1px solid var(--line);
      background: rgba(255,255,255,.06);
      padding: 7px 10px;
      border-radius: 999px;
      font-size: 12.5px;
      color: var(--muted);
    }
    .chip b{ color: var(--text); font-weight:700; }
    .heroActions{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin-top: 12px;
    }
    .btn{
      border: 1px solid var(--line);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 12px;
      cursor:pointer;
      font-weight: 700;
      font-size: 13px;
      display:inline-flex;
      gap:10px;
      align-items:center;
      transition: transform .08s ease, background .15s ease, border-color .15s ease;
      user-select:none;
    }
    .btn:hover{ background: rgba(255,255,255,.10); border-color: rgba(255,255,255,.18); }
    .btn:active{ transform: translateY(1px); }
    .btn.primary{
      background: linear-gradient(135deg, rgba(124,58,237,.45), rgba(59,130,246,.18));
      border-color: rgba(124,58,237,.55);
    }
    .btn.good{
      background: linear-gradient(135deg, rgba(34,197,94,.34), rgba(16,185,129,.14));
      border-color: rgba(34,197,94,.55);
    }
    .btn.warn{
      background: linear-gradient(135deg, rgba(245,158,11,.28), rgba(245,158,11,.12));
      border-color: rgba(245,158,11,.55);
    }

    aside{
      position: sticky;
      top: 14px;
      align-self: start;
      border: 1px solid var(--line);
      border-radius: var(--r);
      background: rgba(255,255,255,.05);
      box-shadow: 0 10px 40px rgba(0,0,0,.35);
      overflow:hidden;
    }
    .sideHead{
      padding: 14px 14px 10px;
      border-bottom: 1px solid var(--line);
      background: rgba(255,255,255,.03);
    }
    .sideHead h2{
      margin:0;
      font-size: 14px;
      letter-spacing:.3px;
      color: var(--muted);
    }
    .searchBox{
      margin-top: 10px;
      display:flex;
      gap:8px;
      align-items:center;
    }
    .searchBox input{
      width:100%;
      border: 1px solid var(--line);
      background: rgba(0,0,0,.18);
      color: var(--text);
      padding: 10px 10px;
      border-radius: 12px;
      outline:none;
      font-size: 13px;
    }
    .searchBox input::placeholder{ color: rgba(232,238,252,.45); }

    nav.toc{
      padding: 10px 10px 14px;
      max-height: calc(100vh - 220px);
      overflow:auto;
    }
    .toc a{
      display:block;
      padding: 9px 10px;
      border-radius: 12px;
      color: var(--muted);
      border: 1px solid transparent;
      font-size: 13px;
      line-height: 1.3;
      margin: 4px 0;
    }
    .toc a:hover{
      background: rgba(255,255,255,.06);
      border-color: rgba(255,255,255,.10);
      color: var(--text);
      text-decoration:none;
    }
    .toc a.active{
      background: rgba(124,58,237,.18);
      border-color: rgba(124,58,237,.35);
      color: var(--text);
    }
    .toc small{
      display:block;
      color: rgba(232,238,252,.45);
      font-weight:600;
      margin-top: 2px;
    }

    main{
      border: 1px solid var(--line);
      border-radius: var(--r);
      background: rgba(255,255,255,.05);
      box-shadow: 0 10px 40px rgba(0,0,0,.35);
      overflow:hidden;
    }
    .content{
      padding: 18px;
    }

    section{
      border: 1px solid var(--line);
      background: rgba(255,255,255,.04);
      border-radius: var(--r);
      padding: 16px;
      margin: 14px 0;
    }
    section h2{
      margin: 0 0 10px;
      font-size: 18px;
      display:flex;
      gap:10px;
      align-items:center;
    }
    .kicker{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.05);
      color: var(--muted);
      font-size: 12px;
      font-weight:800;
      letter-spacing: .2px;
    }
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    .note{
      border:1px solid rgba(124,58,237,.35);
      background: rgba(124,58,237,.12);
      border-radius: 14px;
      padding: 12px;
      color: var(--muted);
      font-size: 13px;
    }
    .note b{ color: var(--text); }
    .ok{
      border-color: rgba(34,197,94,.35);
      background: rgba(34,197,94,.10);
    }
    .warnBox{
      border-color: rgba(245,158,11,.45);
      background: rgba(245,158,11,.10);
    }
    .dangerBox{
      border-color: rgba(239,68,68,.45);
      background: rgba(239,68,68,.10);
    }

    ul,ol{ margin: 8px 0 0 0; padding-right: 18px; color: var(--muted); }
    li{ margin: 6px 0; }
    p{ margin: 10px 0; color: var(--muted); }
    p strong{ color: var(--text); }

    .claims{
      display:grid;
      gap: 10px;
      margin-top: 10px;
    }
    .claim{
      border: 1px solid var(--line);
      background: rgba(0,0,0,.14);
      border-radius: 14px;
      padding: 12px;
    }
    .claimHead{
      display:flex;
      align-items: baseline;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 6px;
    }
    .claimNum{
      font-family: var(--mono);
      font-weight: 900;
      color: #fff;
      background: rgba(124,58,237,.24);
      border: 1px solid rgba(124,58,237,.45);
      padding: 5px 10px;
      border-radius: 999px;
      font-size: 12px;
    }
    .claimTitle{
      font-weight: 900;
      color: var(--text);
      font-size: 13.5px;
    }
    .claimBody{
      color: var(--muted);
      font-size: 13px;
      margin-top: 6px;
    }

    .codeCard{
      border: 1px solid var(--line);
      border-radius: 16px;
      overflow:hidden;
      background: rgba(0,0,0,.20);
      margin-top: 10px;
    }
    .codeTop{
      display:flex;
      justify-content: space-between;
      align-items:center;
      gap: 10px;
      padding: 10px 12px;
      border-bottom: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
    }
    .codeTop .label{
      font-weight: 900;
      font-size: 12.5px;
      color: var(--text);
      display:flex;
      gap:8px;
      align-items:center;
    }
    .codeTop .meta{
      color: rgba(232,238,252,.55);
      font-size: 12px;
    }
    .copyBtn{
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding: 7px 10px;
      border-radius: 12px;
      cursor:pointer;
      font-weight: 800;
      font-size: 12px;
      user-select:none;
    }
    .copyBtn:hover{ background: rgba(255,255,255,.10); }
    pre{
      margin:0;
      padding: 12px;
      overflow:auto;
      font-family: var(--mono);
      font-size: 12.8px;
      line-height: 1.55;
      color: #eaf2ff;
      white-space: pre;
    }
    code{ font-family: var(--mono); }

    .diagram{
      border: 1px solid var(--line);
      border-radius: 16px;
      background: rgba(0,0,0,.16);
      padding: 12px;
      margin-top: 10px;
      overflow:auto;
    }
    .diagram h3{
      margin: 0 0 10px;
      font-size: 13px;
      color: var(--text);
      display:flex;
      gap:10px;
      align-items:center;
    }
    .badge{
      font-family: var(--mono);
      font-size: 11px;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: rgba(232,238,252,.70);
    }

    .table{
      width:100%;
      border-collapse: collapse;
      overflow:hidden;
      border-radius: 16px;
      border: 1px solid var(--line);
      background: rgba(0,0,0,.14);
      margin-top: 10px;
    }
    .table th, .table td{
      padding: 12px 10px;
      border-bottom: 1px solid rgba(255,255,255,.10);
      text-align:right;
      font-size: 13px;
      color: var(--muted);
      vertical-align: top;
    }
    .table th{
      color: var(--text);
      background: rgba(255,255,255,.04);
      font-weight: 900;
    }
    .table tr:last-child td{ border-bottom:none; }

    .footer{
      padding: 14px 18px;
      border-top: 1px solid var(--line);
      color: rgba(232,238,252,.55);
      font-size: 12.5px;
      background: rgba(255,255,255,.02);
      display:flex;
      justify-content: space-between;
      gap: 10px;
      flex-wrap:wrap;
    }

    .hl{
      background: rgba(245,158,11,.18);
      border-radius: 6px;
      padding: 0 4px;
      color: var(--text);
      font-weight: 900;
    }

    .muted{ color: var(--muted2); }

    /* Responsive */
    @media (max-width: 980px){
      .wrap{ grid-template-columns: 1fr; }
      aside{ position: static; }
      nav.toc{ max-height: unset; }
    }

    /* Print */
    @media print{
      body{ background:#fff; color:#000; }
      .wrap{ max-width: 100%; padding: 0; }
      header.hero, aside, .heroActions{ display:none !important; }
      main{ border:none; box-shadow:none; background:#fff; }
      section{ page-break-inside: avoid; border: 1px solid #ddd; background:#fff; }
      pre{ color:#000; }
      a{ color:#000; text-decoration: none; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header class="hero" id="top">
      <div class="heroTop">
        <div class="titleBlock">
          <h1>××¡××š ×¤×˜× ×˜ ××¢×•×¦×‘ â€“ ××‘×˜×—×ª ××™×“×¢ ×”×™×‘×¨×™×“×™×ª</h1>
          <p>
            ××¢×¨×›×ª ×•×©×™×˜×” ×œ××‘×˜×—×ª ×ª×§×©×•×¨×ª ×‘×××¦×¢×•×ª <strong>IPv6 ×¤× ×™××™</strong> + <strong>Bluetooth Overlay</strong> + <strong>MAC Hardware Identity</strong>
            ×¢× ××¢×˜×¤×ª ×—×©×™×¤×” <strong>IPv4</strong> ×•Ö¾<strong>APIPA</strong> ×‘××¦×‘ Offline â€“ ×”×›×œ ×¢×œ ×‘×¡×™×¡ ×¦×™×•×“ ×§×™×™× ×›×™×•×.
          </p>
        </div>

        <div class="chips" aria-label="×ª×’×™×•×ª">
          <div class="chip"><b>Transport</b>: IPv6</div>
          <div class="chip"><b>Gateway</b>: IPv4</div>
          <div class="chip"><b>Offline</b>: APIPA</div>
          <div class="chip"><b>Identity</b>: MAC</div>
          <div class="chip"><b>Physical Auth</b>: Bluetooth</div>
        </div>
      </div>

      <div class="heroActions">
        <button class="btn primary" onclick="window.print()" title="×”×“×¤×¡×” / ×©××™×¨×” ×œ-PDF ×‘×“×¤×“×¤×Ÿ">
          ğŸ–¨ï¸ ×”×“×¤×¡×” / PDF
        </button>
        <button class="btn good" onclick="scrollToId('claims')" title="×§×¤×™×¦×” ×œ×ª×‘×™×¢×•×ª ×”×¤×˜× ×˜">
          âš–ï¸ ×œ×ª×‘×™×¢×•×ª (Claims)
        </button>
        <button class="btn warn" onclick="scrollToId('implementation')" title="×§×¤×™×¦×” ×œ×™×™×©×•×">
          âš™ï¸ ×œ×™×™×©×•× ××¢×©×™
        </button>
        <button class="btn" onclick="toggleAllCode(true)" title="×¤×ª×™×—×ª ×›×œ ×”×§×•×“">
          â–¾ ×”×¦×’ ×§×•×“
        </button>
        <button class="btn" onclick="toggleAllCode(false)" title="×¡×’×•×¨ ×›×œ ×”×§×•×“">
          â–¸ ×”×¡×ª×¨ ×§×•×“
        </button>
      </div>
    </header>

    <aside>
      <div class="sideHead">
        <h2>× ×™×•×•×˜ + ×—×™×¤×•×© ×‘××¡××š</h2>
        <div class="searchBox">
          <input id="q" type="search" placeholder="×—×™×¤×•×© (×œ××©×œ: IPv6, Bluetooth, Claim, Linux, APIPA...)" autocomplete="off" />
        </div>
      </div>
      <nav class="toc" id="toc" aria-label="×ª×•×›×Ÿ ×¢× ×™×™× ×™×">
        <a href="#abstract" data-to="abstract">×ª×§×¦×™×¨ (Abstract) <small>×”×’×“×¨×” ×§×¦×¨×” ×©×œ ×”×”××¦××”</small></a>
        <a href="#field" data-to="field">×ª×—×•× ×”×”××¦××” <small>Security / Networking / Hardware Identity</small></a>
        <a href="#background" data-to="background">×¨×§×¢ ×˜×›× ×•×œ×•×’×™ <small>×”×‘×¢×™×” ×•××” ×—×¡×¨ ×›×™×•×</small></a>
        <a href="#problem" data-to="problem">×‘×¢×™×” ×˜×›× ×•×œ×•×’×™×ª <small>×“×¨×™×©×•×ª ×•×—×¡×¨×™×</small></a>
        <a href="#summary" data-to="summary">×ª××¦×™×ª ×”×”××¦××” <small>××” ×—×“×© ×•××” ××ª×§×‘×œ</small></a>
        <a href="#architecture" data-to="architecture">××¨×›×™×˜×§×˜×•×¨×” <small>×©×›×‘×•×ª + ×–×¨×™××ª ×¢×‘×•×“×”</small></a>
        <a href="#novelty" data-to="novelty">×—×™×“×•×© (Novelty) <small>×œ××” ×œ× ×˜×¨×™×•×•×™××œ×™</small></a>
        <a href="#claims" data-to="claims">×ª×‘×™×¢×•×ª (Claims) <small>× ×™×¡×•×— ××©×¤×˜×™ ×œ×¤×˜× ×˜</small></a>
        <a href="#implementation" data-to="implementation">×™×™×©×•× ××¢×©×™ <small>Linux / Windows / macOS</small></a>
        <a href="#security" data-to="security">× ×™×ª×•×— ××‘×˜×—×” <small>××™×•××™× + ×¢××™×“×•×ª</small></a>
        <a href="#industrial" data-to="industrial">×™×™×©×•××™× ×ª×¢×©×™×™×ª×™×™× <small>Medical / Critical / Offline</small></a>
        <a href="#variants" data-to="variants">×•×¨×™××¦×™×•×ª ×•×”×¨×—×‘×•×ª <small>Zero-Trust / IoT / Policy</small></a>
        <a href="#glossary" data-to="glossary">××™×œ×•×Ÿ ××•×©×’×™× <small>IPv6 / APIPA / MAC</small></a>
      </nav>
    </aside>

    <main>
      <div class="content" id="doc">

        <section id="abstract" data-section>
          <h2><span class="kicker">Abstract</span> ×ª×§×¦×™×¨ ×”×”××¦××”</h2>
          <p>
            ×”×”××¦××” ××ª××¨×ª ××¢×¨×›×ª ×•×©×™×˜×” ×œ××‘×˜×—×ª ×ª×§×©×•×¨×ª ××—×©×•×‘×™×ª ×ª×•×š ×©×™×œ×•×‘ <strong>×–×”×•×ª ×—×•××¨×” (MAC)</strong> ×•Ö¾<strong>××™××•×ª ×¤×™×–×™ ×§×¦×¨Ö¾×˜×•×•×— ×‘×××¦×¢×•×ª Bluetooth</strong>,
            ×›××©×¨ ×ª×¢×‘×•×¨×ª ×”××™×“×¢ ×”×××™×ª×™×ª ××ª× ×”×œ×ª ×‘×ª×•×š <strong>×¨×©×ª IPv6 ×¤× ×™××™×ª</strong>, ×‘×¢×•×“ <strong>IPv4</strong> ××©××© ×›××¢×˜×¤×ª ×—×©×™×¤×” ×—×™×¦×•× ×™×ª (Gateway/Decoy).
            ×‘×”×™×¢×“×¨ ×—×™×‘×•×¨ ××™× ×˜×¨× ×˜, ×”××¢×¨×›×ª ×¢×•×‘×¨×ª ×œ××¦×‘ <strong>APIPA</strong> ×•×××©×™×›×” ×œ×¤×¢×•×œ ××§×•××™×ª, ×ª×•×š ×©××™×¨×” ×¢×œ ×× ×’× ×•× ×™ ×”××™××•×ª ×•×”×‘×§×¨×”.
          </p>
          <div class="grid2">
            <div class="note ok">
              <b>×ª×•×¢×œ×ª ××¨×›×–×™×ª:</b> ×”××‘×˜×—×” × ×©×¢× ×ª ×¢×œ <span class="hl">× ×•×›×—×•×ª ×¤×™×–×™×ª ×©×œ ×—×•××¨×”</span> ×•×œ× ×¨×§ ×¢×œ ×¡×™×¡××”/×›×ª×•×‘×ª/×©×¨×ª.
            </div>
            <div class="note warnBox">
              <b>×”×™×§×£:</b> ××™×•×¢×“ ×œ×¨×©×ª×•×ª ××¨×’×•× ×™×•×ª/×§×¨×™×˜×™×•×ª/×¨×¤×•××™×•×ª, ×›×•×œ×œ ×ª×¨×—×™×©×™ Offline, ×œ×œ× ×¦×•×¨×š ×‘×—×•××¨×” ×—×“×©×”.
            </div>
          </div>
        </section>

        <section id="field" data-section>
          <h2><span class="kicker">Field</span> ×ª×—×•× ×”×”××¦××”</h2>
          <ul>
            <li>××‘×˜×—×ª ××™×“×¢ ×•×”×’× ×ª ×’×™×©×” ×‘×¨×©×ª×•×ª ××—×©×‘×™×</li>
            <li>××™××•×ª ×•×–×”×•×ª ×—×•××¨×” (Hardware Identity & Fingerprinting)</li>
            <li>×¨×©×ª×•×ª ×”×™×‘×¨×™×“×™×•×ª IPv4/IPv6</li>
            <li>Bluetooth Overlay / Mesh ×›××™××•×ª ×¤×™×–×™</li>
            <li>×¤×¢×•×œ×” ×‘Ö¾Offline ×‘×××¦×¢×•×ª APIPA</li>
          </ul>
        </section>

        <section id="background" data-section>
          <h2><span class="kicker">Background</span> ×¨×§×¢ ×˜×›× ×•×œ×•×’×™</h2>
          <p>
            ×¤×ª×¨×•× ×•×ª ××‘×˜×—×” × ×¤×•×¦×™× (×¡×™×¡×××•×ª, VPN, ×ª×¢×•×“×•×ª, ACL ×œ×¤×™ IP) ××©×™×’×™× ×ª×•×¦××•×ª ×˜×•×‘×•×ª, ××š ×œ×¢×™×ª×™×:
            (1) × ×™×ª× ×™× ×œ×’× ×™×‘×”/×”×¢×ª×§×”, (2) ×ª×œ×•×™×™× ×‘×©×¨×ª×™× ×—×™×¦×•× ×™×™×, (3) ×¤×’×™×¢×™× ×œÖ¾Spoofing/Replay, (4) ××™× × ×¢×•×‘×“×™× ×”×™×˜×‘ ×‘×¡×‘×™×‘×•×ª Offline.
          </p>
          <p>
            ×”×”××¦××” ××¦×™×¢×” ×ª×—×œ×™×£/×ª×•×¡×¤×ª: <strong>×–×”×•×ª ×—×•××¨×” ×¨×‘Ö¾×©×›×‘×ª×™×ª + ××™××•×ª ×¤×™×–×™</strong> ×›×ª× ××™ ×œ×¤×ª×™×—×ª ×ª×¢×‘×•×¨×”,
            ×™×—×“ ×¢× ×”×¤×¨×“×” ×‘×¨×•×¨×” ×‘×™×Ÿ <strong>×ª×¢×‘×•×¨×” ×¤× ×™××™×ª (IPv6)</strong> ×œ×‘×™×Ÿ <strong>×—×©×™×¤×” ×—×™×¦×•× ×™×ª (IPv4/APIPA)</strong>.
          </p>
        </section>

        <section id="problem" data-section>
          <h2><span class="kicker">Problem</span> ×”×‘×¢×™×” ×”×˜×›× ×•×œ×•×’×™×ª</h2>
          <div class="note dangerBox">
            <b>×”×‘×¢×™×”:</b> ××¢×¨×›×•×ª ×¨×‘×•×ª ××¡×ª××›×•×ª ×¢×œ â€œ×–×”×•×ª ×¨×©×ªâ€ (IP/×ª×¢×•×“×”/×¡×™×¡××”). ×ª×•×§×£ ××¨×—×•×§ ×™×›×•×œ ×œ× ×¡×•×ª ×œ×–×™×™×£/×œ×’× ×•×‘ ××•×ª×Ÿ.
            ×™×© ×¦×•×¨×š ×‘×× ×’× ×•×Ÿ ×©××—×™×™×‘ <span class="hl">× ×•×›×—×•×ª ×¤×™×–×™×ª ×©×œ ×¨×›×™×‘×™×</span> ×›×“×™ ×œ××¤×©×¨ ×’×™×©×”.
          </div>
          <ul>
            <li>×“×¨×™×©×” ×œ×™×›×•×œ×ª ×¤×¢×•×œ×” ×œ×œ× ××™× ×˜×¨× ×˜ (Offline) ×‘×œ×™ ×œ×¤×’×•×¢ ×‘××‘×˜×—×”.</li>
            <li>×“×¨×™×©×” ×œ×©×™×œ×•×‘ ×‘×¦×™×•×“ ×§×™×™× (Bluetooth + NIC) ×œ×œ× ×—×•××¨×” ×—×“×©×”.</li>
            <li>×”×¤×¨×“×ª ×©×›×‘×ª ×ª×¢×‘×•×¨×” ×××•×‘×˜×—×ª ××©×›×‘×ª ×—×©×™×¤×” ×—×™×¦×•× ×™×ª.</li>
          </ul>
        </section>

        <section id="summary" data-section>
          <h2><span class="kicker">Summary</span> ×ª××¦×™×ª ×”×”××¦××”</h2>
          <p>
            ×”××¢×¨×›×ª ×‘× ×•×™×” ××©×›×‘×•×ª:
          </p>
          <ol>
            <li><strong>Hardware Identity:</strong> ××™×¡×•×£ MAC (Bluetooth/NIC/Wi-Fi) â†’ ×™×¦×™×¨×ª Fingerprint.</li>
            <li><strong>Bluetooth Overlay:</strong> Bluetooth ×¤×¢×™×œ ×•/××• Mesh ××§×•××™ ×›â€œ××¤×ª×— ×¤×™×–×™â€.</li>
            <li><strong>IPv6 ×¤× ×™××™:</strong> ×ª×¢×‘×•×¨×” ×××™×ª×™×ª ×¢×•×‘×¨×ª ×‘Ö¾IPv6 ×¤× ×™××™ â€œ× ×¡×ª×¨â€.</li>
            <li><strong>IPv4 Gateway:</strong> ×—×©×™×¤×” ×—×™×¦×•× ×™×ª ×‘Ö¾IPv4 ×‘×œ×‘×“ ×›Ö¾Decoy/××¢×˜×¤×ª.</li>
            <li><strong>APIPA Offline:</strong> ×‘×¢×ª × ×™×ª×•×§ ××™× ×˜×¨× ×˜ â†’ ×©×™××•×© 169.254/16 ×ª×•×š ×”××©×š ××™××•×ª.</li>
          </ol>

          <div class="note ok">
            <b>×¨×¢×™×•×Ÿ ×œ×™×‘×”:</b> ×’× ×× ××™×©×”×• ××—×–×™×§ ×¡×™×¡××”/×’×™×©×” ×œ×¨×©×ª, ×‘×œ×™ Bluetooth+Fingerprint ×—×•××¨×ª×™ ×ª×¢×‘×•×¨×” ×œ× â€œ× ×¤×ª×—×ªâ€.
          </div>
        </section>

        <section id="architecture" data-section>
          <h2><span class="kicker">Architecture</span> ××¨×›×™×˜×§×˜×•×¨×” ×•×–×¨×™××”</h2>

          <div class="diagram" role="region" aria-label="×ª×¨×©×™× ×–×¨×™××” ×˜×§×¡×˜×•××œ×™">
            <h3>×ª×¨×©×™× ×–×¨×™××” (×˜×§×¡×˜×•××œ×™) <span class="badge">Flow</span></h3>
            <pre><code>[Hardware MAC IDs]
        â†“  (Fingerprint + Key Derivation)
[Bluetooth Auth / Presence Check]
        â†“  (Policy: allow/deny)
[IPv6 Internal Secure Transport]
        â†“  (Encapsulation / routing)
[IPv4 Gateway OR APIPA Offline]
        â†“
[External Internet / Local Network]</code></pre>
          </div>

          <table class="table" aria-label="×©×›×‘×•×ª ×•××˜×¨×•×ª">
            <thead>
              <tr>
                <th>×©×›×‘×”</th>
                <th>××˜×¨×”</th>
                <th>××” ×ª×•×§×£ â€œ×¨×•××”â€</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Bluetooth Presence</strong></td>
                <td>××™××•×ª ×¤×™×–×™ ×§×¦×¨Ö¾×˜×•×•×— / ×ª× ××™ ×’×™×©×”</td>
                <td>×§×©×” ×œ×—×™×§×•×™ ××¨×—×•×§</td>
              </tr>
              <tr>
                <td><strong>MAC Fingerprint</strong></td>
                <td>Seed ×§×¨×™×¤×˜×•×’×¨×¤×™ / Hardware Identity</td>
                <td>××¤×™×œ×• ×× ×–×™×™×¤×• IP â€“ ×—×¡×¨ â€œ××¤×ª×—â€</td>
              </tr>
              <tr>
                <td><strong>IPv6 ×¤× ×™××™</strong></td>
                <td>×ª×¢×‘×•×¨×” ×××•×‘×˜×—×ª, × ×¡×ª×¨×ª, ×§×©×” ×œ×¡×¨×™×§×”</td>
                <td>××¢×˜×¤×ª ×¤× ×™××™×ª ×©××™× ×” × ×—×©×¤×ª</td>
              </tr>
              <tr>
                <td><strong>IPv4 Gateway</strong></td>
                <td>×©×›×‘×ª ×—×©×™×¤×” ×—×™×¦×•× ×™×ª ×‘×œ×‘×“ (Decoy)</td>
                <td>× ×¨××” ×¨×’×™×œ â€“ ××š ×œ× ×”×œ×™×‘×”</td>
              </tr>
              <tr>
                <td><strong>APIPA Offline</strong></td>
                <td>×¤×¢×•×œ×” ××§×•××™×ª ×œ×œ× ××™× ×˜×¨× ×˜</td>
                <td>×’×™×©×” ××§×•××™×ª â€“ ×¢× ××•×ª×• ××™××•×ª</td>
              </tr>
            </tbody>
          </table>
        </section>

        <section id="novelty" data-section>
          <h2><span class="kicker">Novelty</span> ×—×™×“×•×© ×•×”×™×‘×˜×™× ×œ×Ö¾×˜×¨×™×•×•×™××œ×™×™×</h2>
          <ul>
            <li><strong>Bluetooth ××™× ×• ×¨×§ ×ª×§×©×•×¨×ª</strong> â€“ ×”×•× ×”×•×¤×š ×œÖ¾â€œ××¤×ª×— ×¤×™×–×™â€ ×œ××“×™× ×™×•×ª ×’×™×©×”.</li>
            <li><strong>MAC Fingerprint</strong> ××©××© Seed/××¨×›×™×‘ ×‘Ö¾Key Derivation â€“ ×ª×œ×•×™ × ×•×›×—×•×ª ×—×•××¨×”.</li>
            <li><strong>IPv6 ×¤× ×™××™ ×›×ª×—×‘×•×¨×” ×××™×ª×™×ª</strong> ×¢× <strong>IPv4 ×—×™×¦×•× ×™ ×›××¢×˜×¤×ª</strong>.</li>
            <li>×™×›×•×œ×ª <strong>Offline Security</strong> ×‘×××¦×¢×•×ª APIPA ×‘×œ×™ â€œ× ×¤×™×œ×”â€ ×‘××¦×‘ ×œ×œ× ××™× ×˜×¨× ×˜.</li>
          </ul>
        </section>

        <section id="claims" data-section>
          <h2><span class="kicker">Claims</span> ×ª×‘×™×¢×•×ª ×¤×˜× ×˜ (× ×™×¡×•×— ××©×¤×˜×™)</h2>

          <div class="claims" id="claimsList">

            <div class="claim" data-claim>
              <div class="claimHead">
                <span class="claimNum">Claim 1</span>
                <span class="claimTitle">×ª×‘×™×¢×” ×¢×¦×××™×ª â€“ ××¢×¨×›×ª ××‘×˜×—×ª ××™×“×¢ ×¨×‘Ö¾×©×›×‘×ª×™×ª</span>
              </div>
              <div class="claimBody">
                ××¢×¨×›×ª ××‘×˜×—×ª ××™×“×¢, ×”×›×•×œ×œ×ª: (×) ×©×›×‘×ª ××™××•×ª ×—×•××¨×ª×™×ª ×”××‘×•×¡×¡×ª ×¢×œ ×›×ª×•×‘×•×ª MAC ×©×œ ×¨×›×™×‘×™ Bluetooth ×•/××• ×¨×›×™×‘×™ ×ª×§×©×•×¨×ª × ×•×¡×¤×™× ×‘××›×©×™×¨;
                (×‘) ×©×›×‘×ª ××™××•×ª ××§×•××™×ª ××‘×•×¡×¡×ª Bluetooth, ×”×¤×•×¢×œ×ª ×›×ª× ××™ ××•×§×“× ×œ×¤×ª×™×—×ª ×ª×¢×‘×•×¨×ª ×¨×©×ª;
                (×’) ×¨×©×ª ×ª×§×©×•×¨×ª ×¤× ×™××™×ª ××‘×•×¡×¡×ª IPv6 ×©×‘×” ××ª×‘×¦×¢×ª ×”×ª×¢×‘×•×¨×” ×”×××•×‘×˜×—×ª;
                (×“) ×©×›×‘×ª ××¢×‘×¨ ×—×™×¦×•× ×™×ª ××‘×•×¡×¡×ª IPv4 ×”××©××©×ª ×›× ×§×•×“×ª ×—×©×™×¤×” ××•×’×‘×œ×ª;
                (×”) ×× ×’× ×•×Ÿ ×¤×¢×•×œ×” ×‘××¦×‘ ×œ×œ× ××™× ×˜×¨× ×˜ ×‘×××¦×¢×•×ª APIPA; ×›××©×¨ ×¤×ª×™×—×ª ×”×ª×¢×‘×•×¨×” ××ª××¤×©×¨×ª ×¨×§ ×‘× ×•×›×—×•×ª ×¤×™×–×™×ª ×©×œ ×¨×›×™×‘×™ ×”×—×•××¨×” ×”×××•××ª×™×.
              </div>
            </div>

            <div class="claim" data-claim>
              <div class="claimHead">
                <span class="claimNum">Claim 2</span>
                <span class="claimTitle">Seed ×§×¨×™×¤×˜×•×’×¨×¤×™ ××‘×•×¡×¡ MAC</span>
              </div>
              <div class="claimBody">
                ×”××¢×¨×›×ª ×œ×¤×™ Claim 1, ×©×‘×” ×›×ª×•×‘×•×ª ×”Ö¾MAC ××©××©×•×ª ×›Ö¾Seed ×œ×™×¦×™×¨×ª ××¤×ª×—×•×ª ×”×¦×¤× ×” ×“×™× ××™×™× ××• ××¤×ª×—×•×ª ×’×™×©×” ××ª×—×œ×¤×™× (Key Rotation).
              </div>
            </div>

            <div class="claim" data-claim>
              <div class="claimHead">
                <span class="claimNum">Claim 3</span>
                <span class="claimTitle">Bluetooth Mesh / Presence ×›××“×™× ×™×•×ª ×’×™×©×”</span>
              </div>
              <div class="claimBody">
                ×”××¢×¨×›×ª ×œ×¤×™ Claim 1, ×©×‘×” ×©×›×‘×ª Bluetooth ×™×•×¦×¨×ª ×¨×©×ª Mesh ××§×•××™×ª ×‘×™×Ÿ ×¨×›×™×‘×™× ×•/××• ×‘×™×Ÿ ××›×©×™×¨×™× ×¡××•×›×™×,
                ×•×××¤×©×¨×ª ×¤×ª×™×—×ª ×ª×¢×‘×•×¨×” ×¨×§ ×× ××ª×§×™×™××ª × ×•×›×—×•×ª/××™××•×ª ×œ×¤×™ ××“×™× ×™×•×ª ××•×’×“×¨×ª.
              </div>
            </div>

            <div class="claim" data-claim>
              <div class="claimHead">
                <span class="claimNum">Claim 4</span>
                <span class="claimTitle">×”×¡×ª×¨×ª IPv6 ×¤× ×™××™ ××¤× ×™ IPv4 ×—×™×¦×•× ×™</span>
              </div>
              <div class="claimBody">
                ×”××¢×¨×›×ª ×œ×¤×™ Claim 1, ×©×‘×” ×ª×¢×‘×•×¨×ª IPv6 ×¤× ×™××™×ª ××•×¡×ª×¨×ª ××• ××•×¤×¨×“×ª ×›×š ×©×¨×©×ª IPv4 ×—×™×¦×•× ×™×ª ××™× ×” ×™×›×•×œ×” ×œ×’×©×ª ××œ×™×” ×‘××•×¤×Ÿ ×™×©×™×¨.
              </div>
            </div>

            <div class="claim" data-claim>
              <div class="claimHead">
                <span class="claimNum">Claim 5</span>
                <span class="claimTitle">×—×¡×™××ª ×ª×¢×‘×•×¨×” ×‘×”×™×¢×“×¨ Bluetooth</span>
              </div>
              <div class="claimBody">
                ×”××¢×¨×›×ª ×œ×¤×™ Claim 1, ×©×‘×” ×”×©×‘×ª×ª Bluetooth ××• ×”×™×¢×“×¨ × ×•×›×—×•×ª ×¨×›×™×‘×™ Bluetooth ×××•××ª×™× ×’×•×¨××™× ×œ×—×¡×™××ª ×ª×¢×‘×•×¨×” ×—×œ×§×™×ª ××• ××œ××” ×œ×¤×™ ××“×™× ×™×•×ª.
              </div>
            </div>

            <div class="claim" data-claim>
              <div class="claimHead">
                <span class="claimNum">Claim 6</span>
                <span class="claimTitle">Fallback ×œÖ¾APIPA ×‘×¢×ª Offline</span>
              </div>
              <div class="claimBody">
                ×”××¢×¨×›×ª ×œ×¤×™ Claim 1, ×©×‘×” ××¢×‘×¨ ××•×˜×•××˜×™ ×œ×›×ª×•×‘×•×ª APIPA ××ª×‘×¦×¢ ×‘×¢×ª ×”×™×¢×“×¨ ××™× ×˜×¨× ×˜ ××• DHCP, ×ª×•×š ×©××™×¨×” ×¢×œ ××•×ª×Ÿ ×©×›×‘×•×ª ××™××•×ª.
              </div>
            </div>

            <div class="claim" data-claim>
              <div class="claimHead">
                <span class="claimNum">Claim 7</span>
                <span class="claimTitle">×¤×¢×•×œ×” ×œ×œ× ×©×¨×ª ×—×™×¦×•× ×™</span>
              </div>
              <div class="claimBody">
                ×”××¢×¨×›×ª ×œ×¤×™ Claim 1, ×©×‘×” ×”××™××•×ª ×•×§×‘×œ×ª ×”×—×œ×˜×ª ×”×’×™×©×” ××ª×‘×¦×¢×™× ××§×•××™×ª ×œ×œ× ×ª×œ×•×ª ×‘×©×¨×ª ×—×™×¦×•× ×™.
              </div>
            </div>

            <div class="claim" data-claim>
              <div class="claimHead">
                <span class="claimNum">Claim 8</span>
                <span class="claimTitle">×ª×‘×™×¢×” ×¢×¦×××™×ª â€“ ×©×™×˜×” ×œ××‘×˜×—×ª ×ª×§×©×•×¨×ª</span>
              </div>
              <div class="claimBody">
                ×©×™×˜×” ×œ××‘×˜×—×ª ×ª×§×©×•×¨×ª ××—×©×•×‘×™×ª ×”×›×•×œ×œ×ª: ×–×™×”×•×™ ×¨×›×™×‘×™ ×—×•××¨×” ××§×•××™×™×; ×™×¦×™×¨×ª ×˜×‘×™×¢×ª ××¦×‘×¢ ×§×¨×™×¤×˜×•×’×¨×¤×™×ª;
                ×”×¤×¢×œ×ª Bluetooth ×›×ª× ××™ ×’×™×©×”; × ×™×ª×•×‘ ×ª×¢×‘×•×¨×” ×¤× ×™××™×ª ×‘Ö¾IPv6; ×”×¦×’×ª ×©×›×‘×ª IPv4 ×—×™×¦×•× ×™×ª ×‘×œ×‘×“; ×•×‘××¦×‘ Offline ×©×™××•×© ×‘Ö¾APIPA.
              </div>
            </div>

            <div class="claim" data-claim>
              <div class="claimHead">
                <span class="claimNum">Claim 9</span>
                <span class="claimTitle">×¢×“×›×•×Ÿ ×“×™× ××™ ×©×œ Fingerprint</span>
              </div>
              <div class="claimBody">
                ×”×©×™×˜×” ×œ×¤×™ Claim 8, ×©×‘×” ×˜×‘×™×¢×ª ×”××¦×‘×¢ ××©×ª× ×” ×“×™× ××™×ª ×¢× ×©×™× ×•×™ ×¨×›×™×‘ ×—×•××¨×” ××• ×©×™× ×•×™ ××¦×‘ Bluetooth, ×œ×¦×•×¨×š ×× ×™×¢×ª Replay/Cloning.
              </div>
            </div>

            <div class="claim" data-claim>
              <div class="claimHead">
                <span class="claimNum">Claim 10</span>
                <span class="claimTitle">×™×™×©×•× ×‘×ª×©×ª×™×•×ª ×§×¨×™×˜×™×•×ª</span>
              </div>
              <div class="claimBody">
                ×”×©×™×˜×” ×œ×¤×™ Claim 8, ×”××™×•×¢×“×ª ×œ×©×™××•×© ×‘××¢×¨×›×•×ª ×¨×¤×•××™×•×ª, ×ª×¢×©×™×™×ª×™×•×ª, ×ª×—× ×•×ª ×¢×‘×•×“×” ×§×¨×™×˜×™×•×ª, ×¨×©×ª×•×ª ×—×™×¨×•× ××• ×¡×‘×™×‘×•×ª Offline.
              </div>
            </div>

          </div>

          <div class="note">
            <b>×”×¢×¨×”:</b> ×–×”×• × ×™×¡×•×— ×˜×›× ×™Ö¾××©×¤×˜×™ ×‘×¡×™×¡×™. ×¢×•×¨×š ×¤×˜× ×˜×™× ×™×›×•×œ ×œ×—×“×“ × ×™×¡×•×—×™× ×‘×”×ª×× ×œ××“×™× ×” (US/EP/IL),
            ×•×œ×”×•×¡×™×£ ×ª×‘×™×¢×•×ª × ×•×¡×¤×•×ª (×›××• Claims ×œ×ª×¦×•×¨×•×ª IoT, Policy Engines, ××• Keys).
          </div>
        </section>

        <section id="implementation" data-section>
          <h2><span class="kicker">Implementation</span> ×™×™×©×•× ××¢×©×™ ×‘×¦×™×•×“ ×§×™×™× (×”× ×“×¡×™)</h2>
          <p>
            ×œ×”×œ×Ÿ ××™××•×© ×œ×“×•×’××” ×‘×¨××ª â€œBlueprintâ€ ×©× ×™×ª×Ÿ ×œ×™×™×©× ×”×™×•×. ×”××˜×¨×”: ×œ×”×“×’×™× ××ª <strong>×”×¢×™×§×¨×•×Ÿ</strong>:
            ×× Bluetooth ××™× ×• ×¤×¢×™×œ/×××•××ª â€“ <strong>××™×Ÿ ×™×¦×™××ª ×ª×¢×‘×•×¨×”</strong> (××• ×™×¦×™××” ××•×’×‘×œ×ª), ×•×ª×¢×‘×•×¨×” ×¤× ×™××™×ª ××ª×¢×“×¤×ª IPv6.
          </p>

          <div class="grid2">
            <div class="note ok">
              <b>×¦×™×•×“ × ×“×¨×©:</b> ××—×©×‘ ×¨×’×™×œ ×¢× Bluetooth + ×›×¨×˜×™×¡ ×¨×©×ª. × ×ª×‘ ×¨×’×™×œ ××¡×¤×™×§.
            </div>
            <div class="note warnBox">
              <b>×”×¢×¨×ª ×‘×˜×™×—×•×ª:</b> ×§×•×“ ×—×¡×™××ª ×¨×©×ª ×¢×œ×•×œ ×œ× ×ª×§ ××™× ×˜×¨× ×˜. ××•××œ×¥ ×œ×‘×“×•×§ ×‘×¡×‘×™×‘×” × ×™×¡×™×•× ×™×ª/VM.
            </div>
          </div>

          <!-- Linux -->
          <div class="codeCard" data-code>
            <div class="codeTop">
              <div class="label">ğŸ§ Linux â€“ ×¡×§×¨×™×¤×˜ ×”×“×’××” (Presence â†’ Policy â†’ IPv6/IPv4/APIPA)</div>
              <div style="display:flex; gap:10px; align-items:center;">
                <div class="meta">×§×•×‘×¥ ××•××œ×¥: <code>plutus_guard.sh</code></div>
                <button class="copyBtn" data-copy="#code-linux">×”×¢×ª×§</button>
              </div>
            </div>
            <pre id="code-linux"><code>#!/usr/bin/env bash
set -euo pipefail

# =========================
# Plutus Guard (DEMO)
# IPv6 internal preference + IPv4 gateway exposure + APIPA fallback
# Physical presence gate: Bluetooth (hci0) + MAC fingerprint
# =========================

require_cmd() {
  command -v "$1" >/dev/null 2>&1 || { echo "Missing command: $1" >&2; exit 1; }
}

require_cmd ip
require_cmd awk
require_cmd sha256sum

# Optional tools (if present)
HCICFG_OK=0
if command -v hciconfig >/dev/null 2>&1; then
  HCICFG_OK=1
fi

echo "[*] Collecting MAC addresses..."
MACS=$(ip link | awk '/link\/ether/ {print $2}' | tr '\n' ' ' | sed 's/ *$//')
BT_MAC=""
if [[ "$HCICFG_OK" -eq 1 ]]; then
  BT_MAC=$(hciconfig -a 2>/dev/null | awk '/Address:/ {print $2; exit}' || true)
fi

# Fingerprint: combine NIC MACs + (optional) BT MAC
FP_INPUT="NIC:${MACS}|BT:${BT_MAC}"
FP=$(echo -n "$FP_INPUT" | sha256sum | awk '{print $1}')

echo "[*] Hardware Fingerprint (sha256): $FP"
echo "[*] Input: $FP_INPUT"

echo "[*] Checking Bluetooth presence..."
BT_OK=0
if [[ "$HCICFG_OK" -eq 1 ]]; then
  if hciconfig hci0 2>/dev/null | grep -q "UP RUNNING"; then
    BT_OK=1
  fi
else
  echo "[!] hciconfig not found. Install BlueZ tools (package varies by distro)."
fi

# Policy decision
# You can replace this with:
# - a whitelist of approved fingerprints
# - time-based rotation
# - pairing proof (device nearby)
ALLOW=0

# Example policy:
# allow if Bluetooth is UP AND fingerprint is not empty
if [[ "$BT_OK" -eq 1 && -n "$FP" ]]; then
  ALLOW=1
fi

echo "[*] Policy: ALLOW=$ALLOW (Bluetooth=$BT_OK)"

# =========================
# Network control (DEMO)
# Choose firewall: nftables/iptables; here we'll show iptables if present.
# =========================
if command -v iptables >/dev/null 2>&1; then
  echo "[*] Using iptables/ip6tables (demo rules)..."
  # Clear demo rules (safe-ish cleanup)
  iptables -F OUTPUT || true
  ip6tables -F OUTPUT || true

  if [[ "$ALLOW" -eq 1 ]]; then
    # Allow IPv6 output; allow IPv4 only through selected gateway ports (example)
    ip6tables -P OUTPUT ACCEPT
    iptables -P OUTPUT DROP

    # Example: allow IPv4 DNS + HTTPS only (customize)
    iptables -A OUTPUT -p udp --dport 53 -j ACCEPT
    iptables -A OUTPUT -p tcp --dport 443 -j ACCEPT

    echo "[+] Allowed: IPv6 (all). IPv4 limited: DNS(53/udp), HTTPS(443/tcp)."
  else
    # Block everything outward (demo hard lock)
    iptables -P OUTPUT DROP
    ip6tables -P OUTPUT DROP
    echo "[!] BLOCKED: IPv4+IPv6 OUTPUT (Bluetooth not present/authorized)."
  fi
else
  echo "[!] iptables not found. Consider nftables or OS firewall integration."
fi

# =========================
# Offline detection + APIPA fallback (DEMO)
# =========================
# Basic check: default route exists?
DEFAULT_ROUTE=$(ip route show default 2>/dev/null || true)

if [[ -z "$DEFAULT_ROUTE" ]]; then
  echo "[*] No default route detected (likely Offline). Setting APIPA address..."
  # Pick interface automatically (first non-loopback UP)
  IFACE=$(ip -o link show up | awk -F': ' '$2!="lo"{print $2; exit}')
  if [[ -n "$IFACE" ]]; then
    # Add APIPA (example). In real product: choose unique address, avoid conflicts (ARP probe).
    ip addr add 169.254.10.10/16 dev "$IFACE" 2>/dev/null || true
    echo "[+] APIPA configured on $IFACE: 169.254.10.10/16"
  else
    echo "[!] No UP interface found for APIPA."
  fi
else
  echo "[*] Default route exists (Online). IPv4 exposure remains controlled by firewall policy."
fi

echo "[*] Done."</code></pre>
          </div>

          <div class="note">
            <b>××™×š ×œ×”×¤×•×š ××ª ×–×” ×œâ€œ××•×¦×¨ ×××™×ª×™â€:</b>
            ×‘××§×•× ×›×œ×œ â€œBluetooth UPâ€, ×”×©×ª××©×• ×‘××™××•×ª ×—×–×§ ×™×•×ª×¨:
            <ul>
              <li>Whitelist ×©×œ Fingerprints ××•×¨×©×™× (××›×©×™×¨×™×/×¢××“×•×ª)</li>
              <li>Proof-of-Presence: Pairing/Advertising ×¢× ×ª×’ Bluetooth ××•×¨×©×”</li>
              <li>Key Rotation: ××¤×ª×— ××ª×—×œ×£ ×œ×¤×™ ×–××Ÿ + fingerprint</li>
              <li>Policy Engine: ×”×—×œ×˜×•×ª ×œ×¤×™ ××©×ª××©/×–××Ÿ/××™×§×•×/×¨××ª ×¨×©×ª</li>
            </ul>
          </div>

          <!-- Windows -->
          <div class="codeCard" data-code>
            <div class="codeTop">
              <div class="label">ğŸªŸ Windows â€“ Blueprint (PowerShell + Firewall + Bluetooth State)</div>
              <div style="display:flex; gap:10px; align-items:center;">
                <div class="meta">×“×•×’××” ×¢×§×¨×•× ×™×ª (×œ× ×ª×œ×•×™×” ×—×‘×™×œ×•×ª ×¦×“)</div>
                <button class="copyBtn" data-copy="#code-win">×”×¢×ª×§</button>
              </div>
            </div>
            <pre id="code-win"><code># PowerShell Blueprint (concept)
# Goal:
# - Read MAC addresses (adapters)
# - Detect Bluetooth radio state
# - If Bluetooth not enabled â†’ block outbound (or restrict)
# - If enabled â†’ allow outbound per policy

# 1) Collect MACs
$macs = Get-NetAdapter | Where-Object {$_.Status -eq "Up"} | Select-Object -ExpandProperty MacAddress
$fpInput = "NIC:" + ($macs -join ",")
$fp = [System.BitConverter]::ToString(
  (New-Object Security.Cryptography.SHA256Managed).ComputeHash(
    [System.Text.Encoding]::UTF8.GetBytes($fpInput)
  )
) -replace "-", ""
Write-Host "Fingerprint SHA256: $fp"

# 2) Bluetooth presence (basic heuristic)
# Note: Bluetooth APIs vary; simplest checks:
# - service bthserv
# - device class present
$btService = Get-Service -Name bthserv -ErrorAction SilentlyContinue
$btOK = $false
if ($btService -and $btService.Status -eq "Running") { $btOK = $true }

Write-Host "Bluetooth OK: $btOK"

# 3) Firewall policy (example)
# WARNING: rules can impact connectivity.
# Prefer:
# - Create a dedicated rule group and toggle it
# - Allow only required ports when btOK

if (-not $btOK) {
  # Block outbound (example rule - customize)
  New-NetFirewallRule -DisplayName "PlutusGuard Block Outbound" -Direction Outbound -Action Block -Enabled True -Profile Any
  Write-Host "Outbound blocked (Bluetooth not OK)."
} else {
  # Remove block rule
  Get-NetFirewallRule -DisplayName "PlutusGuard Block Outbound" -ErrorAction SilentlyContinue | Remove-NetFirewallRule
  # Optional: add restrictive allowlist rules instead of full allow
  Write-Host "Outbound allowed (policy can be refined)."
}

# 4) Offline mode / APIPA
# Windows auto-assigns APIPA when DHCP fails.
# You can detect it and keep policy consistent:
# Get-NetIPAddress | Where-Object {$_.IPAddress -like "169.254*"} </code></pre>
          </div>

          <!-- macOS -->
          <div class="codeCard" data-code>
            <div class="codeTop">
              <div class="label">ğŸ macOS â€“ Blueprint (CoreBluetooth + PF Firewall / Network Extension)</div>
              <div style="display:flex; gap:10px; align-items:center;">
                <div class="meta">×¢×§×¨×•× ×•×ª ××¢×¨×›×ª×™×™×</div>
                <button class="copyBtn" data-copy="#code-mac">×”×¢×ª×§</button>
              </div>
            </div>
            <pre id="code-mac"><code># macOS Blueprint (concept)
# - Use CoreBluetooth to detect authorized beacon/tag or local Bluetooth radio state
# - Use Network Extension (preferred for modern macOS) or pf firewall rules
# - Gate outbound traffic until presence/auth passes

# Detect interfaces & MAC (CLI)
ifconfig | grep -E "ether "   # MACs
networksetup -listallhardwareports

# PF approach (concept)
# 1) Create anchors in /etc/pf.anchors/plutusguard
# 2) Load rules in /etc/pf.conf:
#    anchor "plutusguard"
#    load anchor "plutusguard" from "/etc/pf.anchors/plutusguard"
# 3) In plutusguard anchor:
#    block out all
#    pass out proto tcp to any port 443
# Toggle anchor contents based on Bluetooth auth result.</code></pre>
          </div>

          <div class="note ok">
            <b>×©×›×‘×ª IPv6 ×¤× ×™××™×ª (×¨×™××œ×™×ª):</b> ×‘Ö¾Linux ××¤×©×¨ ×œ×”×§×™× <strong>Network Namespace</strong> / <strong>VRF</strong> ×¢×‘×•×¨ â€œ×¨×©×ª ×××•×‘×˜×—×ªâ€,
            ×•×œ×”×¢×‘×™×¨ ××œ×™×” ×ª×”×œ×™×›×™× ×¨×’×™×©×™× ×‘×œ×‘×“; ×”×—×•×¦×” ×¢×•×‘×¨×™× ×“×¨×š Gateway ××‘×•×§×¨.
          </div>
        </section>

        <section id="security" data-section>
          <h2><span class="kicker">Security</span> × ×™×ª×•×— ××‘×˜×—×”: ××™×•××™× ×•×¢××™×“×•×ª</h2>
          <table class="table" aria-label="××™×•××™× ××•×œ ×©×›×‘×•×ª">
            <thead>
              <tr>
                <th>××™×•×</th>
                <th>××” ×§×•×¨×” ×‘×¤×ª×¨×•× ×•×ª ×¨×’×™×œ×™×</th>
                <th>××” ×§×•×¨×” ×›××Ÿ</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>IP Spoofing</strong></td>
                <td>××¤×©×¨ ×œ× ×¡×•×ª ×œ×–×™×™×£ ××§×•×¨/×™×¢×“</td>
                <td>×¢×“×™×™×Ÿ ××™×Ÿ â€œ××¤×ª×— ×¤×™×–×™â€ (Bluetooth) ×•××™×Ÿ fingerprint ×—×•××¨×ª×™</td>
              </tr>
              <tr>
                <td><strong>Password Leak</strong></td>
                <td>×“×œ×™×¤×ª ×¡×™×¡××” ×™×›×•×œ×” ×œ×”×¡×¤×™×§</td>
                <td>×¡×™×¡××” ×œ×‘×“×” ×œ× ××¡×¤×™×§×” â€“ × ×“×¨×© Bluetooth Presence</td>
              </tr>
              <tr>
                <td><strong>Replay</strong></td>
                <td>×©×™×“×•×¨ ×—×•×–×¨ ×œ×¢×™×ª×™× ××¦×œ×™×—</td>
                <td>××¤×©×¨ ×œ×”×•×¡×™×£ Key Rotation ××‘×•×¡×¡ ×–××Ÿ+fingerprint</td>
              </tr>
              <tr>
                <td><strong>Offline Attack</strong></td>
                <td>×œ×¢×™×ª×™× ××™×Ÿ ××“×™× ×™×•×ª / ×¤×•×ª×—×™× ×”×›×œ</td>
                <td>APIPA ×¢× ××•×ª×” ××“×™× ×™×•×ª â€“ ×”××‘×˜×—×” ×œ× × ×•×¤×œ×ª</td>
              </tr>
              <tr>
                <td><strong>Recon/Scan</strong></td>
                <td>IPv4 ×§×œ ×™×—×¡×™×ª ×œ×¡×¨×™×§×”</td>
                <td>×”×œ×™×‘×” ×‘Ö¾IPv6 ×¤× ×™××™, ×”×—×©×™×¤×” ×‘Ö¾IPv4 ××™× ×™××œ×™×ª</td>
              </tr>
            </tbody>
          </table>

          <div class="note warnBox">
            <b>×”×¢×¨×ª ×ª×›× ×•×Ÿ:</b> MAC ×œ×‘×“×• × ×™×ª×Ÿ ×œ×–×™×•×£ ×‘××¦×‘×™× ××¡×•×™××™×, ×œ×›×Ÿ ×”×—×™×“×•×© ×”××©××¢×•×ª×™ ×”×•× ×©×™×œ×•×‘×• ×¢×
            <strong>Bluetooth Presence</strong> + <strong>××“×™× ×™×•×ª ××§×•××™×ª</strong> + <strong>××¤×ª×—×•×ª ××ª×—×œ×¤×™×</strong>.
          </div>
        </section>

        <section id="industrial" data-section>
          <h2><span class="kicker">Industrial</span> ×©×™××•×©×™× ×ª×¢×©×™×™×ª×™×™×</h2>
          <ul>
            <li><strong>××¢×¨×›×•×ª ×¨×¤×•××™×•×ª:</strong> ×¢××“×•×ª ×˜×™×¤×•×œ/××“×™×“×” ×”××—×™×™×‘×•×ª × ×•×›×—×•×ª ×¤×™×–×™×ª ×©×œ ×¦×™×•×“ ××•×¨×©×”.</li>
            <li><strong>×ª×©×ª×™×•×ª ×§×¨×™×˜×™×•×ª:</strong> ×‘×§×¨×” ×ª×¢×©×™×™×ª×™×ª, ×ª×—× ×•×ª SCADA, ××¢×¨×›×•×ª ×—×™×¨×•×.</li>
            <li><strong>××¨×’×•× ×™×:</strong> ×ª×—× ×•×ª ×¢×‘×•×“×” ×¨×’×™×©×•×ª, ×”×¨×©××•×ª ×œ×¤×™ â€œ×¦×™×•×“ ×‘×¡×‘×™×‘×”â€ (Proximity).</li>
            <li><strong>×¡×‘×™×‘×•×ª Offline:</strong> ××ª×¨×™× ×œ×œ× ××™× ×˜×¨× ×˜ ×§×‘×•×¢ â€“ ××‘×˜×—×” × ×©××¨×ª.</li>
          </ul>
        </section>

        <section id="variants" data-section>
          <h2><span class="kicker">Variants</span> ×•×¨×™××¦×™×•×ª ×•×”×¨×—×‘×•×ª</h2>
          <div class="grid2">
            <div class="note ok">
              <b>Zero Trust Mode:</b> ×›×œ ×™×¦×™××” ×“×•×¨×©×ª Policy Engine ×©××—×œ×™×˜ ×œ×¤×™ ××©×ª××©/×–××Ÿ/×¤×¨×•×¤×™×œ ×¨×©×ª + Presence.
            </div>
            <div class="note">
              <b>IoT / Tags:</b> ×”×•×¡×¤×ª ×ª×’ Bluetooth ××•×¨×©×” (Beacon) ×©××’×“×™×¨ â€œ××–×•×¨ ×××•×‘×˜×—â€ â€“ ×‘×œ×™ ×ª×’ ××™×Ÿ ×’×™×©×”.
            </div>
          </div>
          <ul>
            <li><strong>Key Rotation:</strong> ××¤×ª×— ××ª×—×œ×£ ×›×œ N ×“×§×•×ª: K = H(Fingerprint || TimeSlice || Secret)</li>
            <li><strong>Whitelist:</strong> ×¨×©×™××ª fingerprints ××•×¨×©×™× ××§×•××™×ª (×§×•×‘×¥ ×—×ª×•×/TPM ×× ×§×™×™×)</li>
            <li><strong>Granular Egress:</strong> IPv4 ×¨×§ ×œ×¤×•×¨×˜×™× ××•×’×“×¨×™× (DNS/HTTPS) ×‘×¢×•×“ IPv6 ×¤× ×™××™ ××œ×</li>
            <li><strong>Split-Tunnel Apps:</strong> ×¨×§ ××¤×œ×™×§×¦×™×•×ª ××¡×•×™××•×ª ×¨×¦×•×ª ×‘×ª×•×š namespace ×××•×‘×˜×—</li>
          </ul>
        </section>

        <section id="glossary" data-section>
          <h2><span class="kicker">Glossary</span> ××™×œ×•×Ÿ ××•×©×’×™× ×§×¦×¨</h2>
          <ul>
            <li><strong>IPv6:</strong> ×¤×¨×•×˜×•×§×•×œ ××™× ×˜×¨× ×˜ ×¢× ××¨×—×‘ ×›×ª×•×‘×•×ª ×¢×¦×•×; ×××¤×©×¨ ×¨×©×ª ×¤× ×™××™×ª ×§×©×” ×œ×¡×¨×™×§×”.</li>
            <li><strong>IPv4:</strong> ×¤×¨×•×˜×•×§×•×œ × ×¤×•×¥; ×›××Ÿ ××©××© ××¢×˜×¤×ª ×—×™×¦×•× ×™×ª/× ×§×•×“×ª ××¢×‘×¨ (Gateway).</li>
            <li><strong>APIPA:</strong> ×›×ª×•×‘×•×ª <code>169.254.0.0/16</code> ×©××•×§×¦×•×ª ××•×˜×•××˜×™×ª ×›×©××™×Ÿ DHCP/××™× ×˜×¨× ×˜.</li>
            <li><strong>MAC Address:</strong> ××–×”×” ×—×•××¨×” ×©×œ ×›×¨×˜×™×¡ ×¨×©×ª/BT; ××©××© ×›××Ÿ ×›×—×œ×§ ××˜×‘×™×¢×ª ××¦×‘×¢.</li>
            <li><strong>Bluetooth Presence:</strong> ×ª× ××™ ×’×™×©×” ×”××‘×•×¡×¡ ×¢×œ × ×•×›×—×•×ª/××™××•×ª ×§×¦×¨Ö¾×˜×•×•×—.</li>
          </ul>

          <div class="note">
            <b>×¡×™×›×•× ××©×¤×˜ ××¤×ª×—:</b> ×”××‘×˜×—×” ××™× ×” ×ª×œ×•×™×” ×¨×§ ×‘×›×ª×•×‘×ª/×¡×™×¡××”, ××œ× ×‘Ö¾<span class="hl">× ×•×›×—×•×ª ×¤×™×–×™×ª ×©×œ ×”×—×•××¨×”</span> ×©××™×™×¦×¨×ª ×–×”×•×ª ×¨×‘Ö¾×©×›×‘×ª×™×ª.
          </div>
        </section>

      </div>

      <div class="footer">
        <div>××¡××š ×¤×˜× ×˜/Blueprint â€“ ××‘×˜×—×ª ××™×“×¢ ×”×™×‘×¨×™×“×™×ª (IPv6 + Bluetooth + MAC + IPv4/APIPA)</div>
        <div class="muted">×˜×™×¤: ×”×©×ª××© ×‘×—×™×¤×•×© ×›×“×™ ×œ×”×“×’×™×© ××•× ×—×™×, ×•×‘×›×¤×ª×•×¨ ×”×“×¤×¡×” ×›×“×™ ×œ×©××•×¨ ×œ-PDF</div>
      </div>
    </main>
  </div>

  <script>
    // Smooth scroll
    function scrollToId(id){
      const el = document.getElementById(id);
      if(!el) return;
      el.scrollIntoView({behavior:"smooth", block:"start"});
      history.replaceState(null, "", "#"+id);
    }

    // TOC active state on scroll
    const tocLinks = Array.from(document.querySelectorAll(".toc a"));
    const sections = Array.from(document.querySelectorAll("[data-section]"));

    const io = new IntersectionObserver((entries)=>{
      const visible = entries.filter(e => e.isIntersecting)
                            .sort((a,b)=> b.intersectionRatio - a.intersectionRatio)[0];
      if(!visible) return;
      const id = visible.target.id;
      tocLinks.forEach(a => a.classList.toggle("active", a.dataset.to === id));
    }, {rootMargin: "-20% 0px -70% 0px", threshold: [0.05, 0.15, 0.25]});

    sections.forEach(s => io.observe(s));

    // Click TOC
    tocLinks.forEach(a=>{
      a.addEventListener("click", (e)=>{
        e.preventDefault();
        scrollToId(a.dataset.to);
      });
    });

    // Copy buttons
    function copyTextFrom(selector){
      const el = document.querySelector(selector);
      if(!el) return;
      const text = el.innerText;
      navigator.clipboard.writeText(text).then(()=> {
        toast("×”×•×¢×ª×§ ×œ×œ×•×— ×”×”×¢×ª×§×” âœ…");
      }).catch(()=> {
        // Fallback
        const ta = document.createElement("textarea");
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        try{ document.execCommand("copy"); toast("×”×•×¢×ª×§ âœ…"); }catch(e){ toast("×œ× ×”×¦×œ×—×ª×™ ×œ×”×¢×ª×™×§ âŒ"); }
        document.body.removeChild(ta);
      });
    }

    document.querySelectorAll("[data-copy]").forEach(btn=>{
      btn.addEventListener("click", ()=>{
        copyTextFrom(btn.getAttribute("data-copy"));
      });
    });

    // Toggle all code blocks visibility
    function toggleAllCode(show){
      document.querySelectorAll(".codeCard").forEach(card=>{
        const pre = card.querySelector("pre");
        if(!pre) return;
        pre.style.display = show ? "block" : "none";
      });
      toast(show ? "×›×œ ×”×§×•×“ ××•×¦×’" : "×›×œ ×”×§×•×“ ×”×•×¡×ª×¨");
    }
    window.toggleAllCode = toggleAllCode;

    // Search highlight across main content
    const q = document.getElementById("q");
    const doc = document.getElementById("doc");
    let last = "";

    function escapeRegExp(s){ return s.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'); }

    function clearHighlights(){
      // Remove <mark data-hl>
      doc.querySelectorAll("mark[data-hl]").forEach(m=>{
        const t = document.createTextNode(m.textContent);
        m.replaceWith(t);
      });
      // Normalize text nodes
      doc.normalize();
    }

    function highlight(term){
      if(!term) return;
      const rx = new RegExp(escapeRegExp(term), "gi");

      // Walk text nodes only (skip script/style)
      const walker = document.createTreeWalker(doc, NodeFilter.SHOW_TEXT, {
        acceptNode: (node)=>{
          const p = node.parentElement;
          if(!p) return NodeFilter.FILTER_REJECT;
          const tag = p.tagName?.toLowerCase();
          if(["script","style"].includes(tag)) return NodeFilter.FILTER_REJECT;
          if(!node.nodeValue || !node.nodeValue.trim()) return NodeFilter.FILTER_REJECT;
          return NodeFilter.FILTER_ACCEPT;
        }
      });

      const nodes = [];
      while(walker.nextNode()) nodes.push(walker.currentNode);

      nodes.forEach(node=>{
        const text = node.nodeValue;
        if(!rx.test(text)) return;
        rx.lastIndex = 0;

        const frag = document.createDocumentFragment();
        let lastIndex = 0;
        let m;
        while((m = rx.exec(text)) !== null){
          const before = text.slice(lastIndex, m.index);
          if(before) frag.appendChild(document.createTextNode(before));

          const mark = document.createElement("mark");
          mark.setAttribute("data-hl","1");
          mark.className = "hl";
          mark.textContent = text.slice(m.index, m.index + m[0].length);
          frag.appendChild(mark);

          lastIndex = m.index + m[0].length;
        }
        const after = text.slice(lastIndex);
        if(after) frag.appendChild(document.createTextNode(after));

        node.parentNode.replaceChild(frag, node);
      });
    }

    q.addEventListener("input", ()=>{
      const term = q.value.trim();
      if(term === last) return;
      clearHighlights();
      if(term.length >= 2){
        highlight(term);
      }
      last = term;
    });

    // Tiny toast
    let toastTimer = null;
    function toast(msg){
      let t = document.getElementById("toast");
      if(!t){
        t = document.createElement("div");
        t.id = "toast";
        t.style.position = "fixed";
        t.style.left = "14px";
        t.style.bottom = "14px";
        t.style.zIndex = "9999";
        t.style.padding = "10px 12px";
        t.style.borderRadius = "12px";
        t.style.border = "1px solid rgba(255,255,255,.16)";
        t.style.background = "rgba(0,0,0,.45)";
        t.style.color = "rgba(232,238,252,.92)";
        t.style.backdropFilter = "blur(10px)";
        t.style.boxShadow = "0 14px 40px rgba(0,0,0,.45)";
        t.style.fontWeight = "800";
        t.style.fontSize = "13px";
        t.style.opacity = "0";
        t.style.transform = "translateY(8px)";
        t.style.transition = "opacity .18s ease, transform .18s ease";
        document.body.appendChild(t);
      }
      t.textContent = msg;
      t.style.opacity = "1";
      t.style.transform = "translateY(0)";
      clearTimeout(toastTimer);
      toastTimer = setTimeout(()=>{
        t.style.opacity = "0";
        t.style.transform = "translateY(8px)";
      }, 1600);
    }

    // Start with code visible (feel free to change to false)
    toggleAllCode(true);

    // If URL has hash, scroll
    if(location.hash){
      const id = location.hash.replace("#","");
      setTimeout(()=> scrollToId(id), 50);
    }
  </script>
</body>
</html>
